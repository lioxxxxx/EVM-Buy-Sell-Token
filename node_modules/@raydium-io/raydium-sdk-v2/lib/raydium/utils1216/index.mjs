var cn=Object.defineProperty,ln=Object.defineProperties;var fn=Object.getOwnPropertyDescriptors;var Ee=Object.getOwnPropertySymbols;var xt=Object.prototype.hasOwnProperty,At=Object.prototype.propertyIsEnumerable;var Pt=(e,t,n)=>t in e?cn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,G=(e,t)=>{for(var n in t||(t={}))xt.call(t,n)&&Pt(e,n,t[n]);if(Ee)for(var n of Ee(t))At.call(t,n)&&Pt(e,n,t[n]);return e},ne=(e,t)=>ln(e,fn(t));var De=(e,t)=>{var n={};for(var r in e)xt.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&Ee)for(var r of Ee(e))t.indexOf(r)<0&&At.call(e,r)&&(n[r]=e[r]);return n};import{TOKEN_PROGRAM_ID as _r}from"@solana/spl-token";import{PublicKey as Fr,Transaction as Tt,TransactionInstruction as vr}from"@solana/web3.js";import un from"bn.js";import{get as St,set as mn}from"lodash";var Je=class{constructor(t){this.logLevel=t.logLevel!==void 0?t.logLevel:0,this.name=t.name}set level(t){this.logLevel=t}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(t){return t<=this.logLevel}error(...t){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...t),this):this}logWithError(...t){let n=t.map(r=>typeof r=="object"?JSON.stringify(r):r).join(", ");throw new Error(n)}warning(...t){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...t),this):this}info(...t){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...t),this):this}debug(...t){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...t),this):this}},Bt={},dn={};function H(e){let t=St(Bt,e);if(!t){let n=St(dn,e);t=new Je({name:e,logLevel:n}),mn(Bt,e,t)}return t}import{PublicKey as Be,sendAndConfirmTransaction as pt,Transaction as ke,TransactionMessage as Le,VersionedTransaction as Ce}from"@solana/web3.js";import Nr from"axios";var Xe={CreateAccount:"CreateAccount",InitAccount:"InitAccount",CreateATA:"CreateATA",CloseAccount:"CloseAccount",TransferAmount:"TransferAmount",InitMint:"InitMint",MintTo:"MintTo",InitMarket:"InitMarket",Util1216OwnerClaim:"Util1216OwnerClaim",SetComputeUnitPrice:"SetComputeUnitPrice",SetComputeUnitLimit:"SetComputeUnitLimit",ClmmCreatePool:"ClmmCreatePool",ClmmOpenPosition:"ClmmOpenPosition",ClmmIncreasePosition:"ClmmIncreasePosition",ClmmDecreasePosition:"ClmmDecreasePosition",ClmmClosePosition:"ClmmClosePosition",ClmmSwapBaseIn:"ClmmSwapBaseIn",ClmmSwapBaseOut:"ClmmSwapBaseOut",ClmmInitReward:"ClmmInitReward",ClmmSetReward:"ClmmSetReward",ClmmCollectReward:"ClmmCollectReward",AmmV4Swap:"AmmV4Swap",AmmV4AddLiquidity:"AmmV4AddLiquidity",AmmV4RemoveLiquidity:"AmmV4RemoveLiquidity",AmmV4SimulatePoolInfo:"AmmV4SimulatePoolInfo",AmmV4SwapBaseIn:"AmmV4SwapBaseIn",AmmV4SwapBaseOut:"AmmV4SwapBaseOut",AmmV4CreatePool:"AmmV4CreatePool",AmmV4InitPool:"AmmV4InitPool",AmmV5AddLiquidity:"AmmV5AddLiquidity",AmmV5RemoveLiquidity:"AmmV5RemoveLiquidity",AmmV5SimulatePoolInfo:"AmmV5SimulatePoolInfo",AmmV5SwapBaseIn:"AmmV5SwapBaseIn",AmmV5SwapBaseOut:"AmmV5SwapBaseOut",RouteSwap:"RouteSwap",RouteSwap1:"RouteSwap1",RouteSwap2:"RouteSwap2",FarmV3Deposit:"FarmV3Deposit",FarmV3Withdraw:"FarmV3Withdraw",FarmV3CreateLedger:"FarmV3CreateLedger",FarmV5Deposit:"FarmV5Deposit",FarmV5Withdraw:"FarmV5Withdraw",FarmV5CreateLedger:"FarmV5CreateLedger",FarmV6Deposit:"FarmV6Deposit",FarmV6Withdraw:"FarmV6Withdraw",FarmV6Create:"FarmV6Create",FarmV6Restart:"FarmV6Restart",FarmV6CreatorAddReward:"FarmV6CreatorAddReward",FarmV6CreatorWithdraw:"FarmV6CreatorWithdraw",CpmmCreatePool:"CpmmCreatePool",CpmmAddLiquidity:"CpmmAddLiquidity",CpmmWithdrawLiquidity:"CpmmWithdrawLiquidity",CpmmSwapBaseIn:"CpmmSwapBaseIn",CpmmSwapBaseOut:"CpmmSwapBaseOut"};import{PublicKey as pn,ComputeBudgetProgram as kt,Transaction as Ct,TransactionMessage as gn,Keypair as Nt,VersionedTransaction as It}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as hn}from"@solana/spl-token";var Lt=H("Raydium_txUtil"),Et=1644;function Me(e){let t=[],n=[];return e.microLamports&&(t.push(kt.setComputeUnitPrice({microLamports:e.microLamports})),n.push(Xe.SetComputeUnitPrice)),e.units&&(t.push(kt.setComputeUnitLimit({units:e.units})),n.push(Xe.SetComputeUnitLimit)),{instructions:t,instructionTypes:n}}async function de(e,t){var r,i;let n=t!=null?t:"confirmed";try{return((i=await((r=e.getLatestBlockhash)==null?void 0:r.call(e,{commitment:n})))==null?void 0:i.blockhash)||(await e.getRecentBlockhash(n)).blockhash}catch{return(await e.getRecentBlockhash(n)).blockhash}}function Qe(e,t){e.length<1&&Lt.logWithError(`no instructions provided: ${e.toString()}`),t.length<1&&Lt.logWithError(`no signers provided:, ${t.toString()}`);let n=new Ct;n.recentBlockhash="11111111111111111111111111111111",n.feePayer=t[0],n.add(...e);try{return Buffer.from(n.serialize({verifySignatures:!1})).toString("base64").length<Et}catch{return!1}}function Re(e,t){let[n,r]=pn.findProgramAddressSync(e,t);return{publicKey:n,nonce:r}}function we({instructions:e,payer:t,signers:n}){return Qe(e,[t,...n])}function Te({instructions:e,payer:t,lookupTableAddressAccount:n,recentBlockhash:r=Nt.generate().publicKey.toString()}){let o=new gn({payerKey:t,recentBlockhash:r,instructions:e}).compileToV0Message(Object.values(n!=null?n:{}));try{return Buffer.from(new It(o).serialize()).toString("base64").length<Et}catch{return!1}}var bn=e=>Buffer.isBuffer(e)?e:e instanceof Uint8Array?Buffer.from(e.buffer,e.byteOffset,e.byteLength):Buffer.from(e);function ce(e){let t=[];return e.forEach(n=>{n instanceof Ct&&(n.recentBlockhash||(n.recentBlockhash=hn.toBase58()),n.feePayer||(n.feePayer=Nt.generate().publicKey));let r=n.serialize({requireAllSignatures:!1,verifySignatures:!1});n instanceof It&&(r=bn(r));let i=r.toString("base64");t.push(i)}),console.log("simulate tx string:",t),t}import{PublicKey as tn,AddressLookupTableAccount as ze}from"@solana/web3.js";import{PublicKey as Cr}from"@solana/web3.js";import{MINT_SIZE as ca,TOKEN_PROGRAM_ID as la,getTransferFeeConfig as fa,unpackMint as ma}from"@solana/spl-token";import{PublicKey as es}from"@solana/web3.js";import ns from"bn.js";import Sr from"big.js";import Ro from"bn.js";import z from"bn.js";var pe=9e15,se=1e9,$e="0123456789abcdef",_e="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",Fe="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",et={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-pe,maxE:pe,crypto:!1},Ot,te,B=!0,Ke="[DecimalError] ",oe=Ke+"Invalid argument: ",_t=Ke+"Precision limit exceeded",Ft=Ke+"crypto unavailable",vt="[object Decimal]",U=Math.floor,F=Math.pow,yn=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,wn=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Tn=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,Kt=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,X=1e7,A=7,Pn=9007199254740991,xn=_e.length-1,tt=Fe.length-1,p={toStringTag:vt};p.absoluteValue=p.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),x(e)};p.ceil=function(){return x(new this.constructor(this),this.e+1,2)};p.clampedTo=p.clamp=function(e,t){var n,r=this,i=r.constructor;if(e=new i(e),t=new i(t),!e.s||!t.s)return new i(NaN);if(e.gt(t))throw Error(oe+t);return n=r.cmp(e),n<0?e:r.cmp(t)>0?t:new i(r)};p.comparedTo=p.cmp=function(e){var t,n,r,i,o=this,s=o.d,a=(e=new o.constructor(e)).d,u=o.s,c=e.s;if(!s||!a)return!u||!c?NaN:u!==c?u:s===a?0:!s^u<0?1:-1;if(!s[0]||!a[0])return s[0]?u:a[0]?-c:0;if(u!==c)return u;if(o.e!==e.e)return o.e>e.e^u<0?1:-1;for(r=s.length,i=a.length,t=0,n=r<i?r:i;t<n;++t)if(s[t]!==a[t])return s[t]>a[t]^u<0?1:-1;return r===i?0:r>i^u<0?1:-1};p.cosine=p.cos=function(){var e,t,n=this,r=n.constructor;return n.d?n.d[0]?(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+A,r.rounding=1,n=An(r,Gt(r,n)),r.precision=e,r.rounding=t,x(te==2||te==3?n.neg():n,e,t,!0)):new r(1):new r(NaN)};p.cubeRoot=p.cbrt=function(){var e,t,n,r,i,o,s,a,u,c,l=this,f=l.constructor;if(!l.isFinite()||l.isZero())return new f(l);for(B=!1,o=l.s*F(l.s*l,1/3),!o||Math.abs(o)==1/0?(n=V(l.d),e=l.e,(o=(e-n.length+1)%3)&&(n+=o==1||o==-2?"0":"00"),o=F(n,1/3),e=U((e+1)/3)-(e%3==(e<0?-1:2)),o==1/0?n="5e"+e:(n=o.toExponential(),n=n.slice(0,n.indexOf("e")+1)+e),r=new f(n),r.s=l.s):r=new f(o.toString()),s=(e=f.precision)+3;;)if(a=r,u=a.times(a).times(a),c=u.plus(l),r=E(c.plus(l).times(a),c.plus(u),s+2,1),V(a.d).slice(0,s)===(n=V(r.d)).slice(0,s))if(n=n.slice(s-3,s+1),n=="9999"||!i&&n=="4999"){if(!i&&(x(a,e+1,0),a.times(a).times(a).eq(l))){r=a;break}s+=4,i=1}else{(!+n||!+n.slice(1)&&n.charAt(0)=="5")&&(x(r,e+1,1),t=!r.times(r).times(r).eq(l));break}return B=!0,x(r,e,f.rounding,t)};p.decimalPlaces=p.dp=function(){var e,t=this.d,n=NaN;if(t){if(e=t.length-1,n=(e-U(this.e/A))*A,e=t[e],e)for(;e%10==0;e/=10)n--;n<0&&(n=0)}return n};p.dividedBy=p.div=function(e){return E(this,new this.constructor(e))};p.dividedToIntegerBy=p.divToInt=function(e){var t=this,n=t.constructor;return x(E(t,new n(e),0,1,1),n.precision,n.rounding)};p.equals=p.eq=function(e){return this.cmp(e)===0};p.floor=function(){return x(new this.constructor(this),this.e+1,3)};p.greaterThan=p.gt=function(e){return this.cmp(e)>0};p.greaterThanOrEqualTo=p.gte=function(e){var t=this.cmp(e);return t==1||t===0};p.hyperbolicCosine=p.cosh=function(){var e,t,n,r,i,o=this,s=o.constructor,a=new s(1);if(!o.isFinite())return new s(o.s?1/0:NaN);if(o.isZero())return a;n=s.precision,r=s.rounding,s.precision=n+Math.max(o.e,o.sd())+4,s.rounding=1,i=o.d.length,i<32?(e=Math.ceil(i/3),t=(1/We(4,e)).toString()):(e=16,t="2.3283064365386962890625e-10"),o=ge(s,1,o.times(t),new s(1),!0);for(var u,c=e,l=new s(8);c--;)u=o.times(o),o=a.minus(u.times(l.minus(u.times(l))));return x(o,s.precision=n,s.rounding=r,!0)};p.hyperbolicSine=p.sinh=function(){var e,t,n,r,i=this,o=i.constructor;if(!i.isFinite()||i.isZero())return new o(i);if(t=o.precision,n=o.rounding,o.precision=t+Math.max(i.e,i.sd())+4,o.rounding=1,r=i.d.length,r<3)i=ge(o,2,i,i,!0);else{e=1.4*Math.sqrt(r),e=e>16?16:e|0,i=i.times(1/We(5,e)),i=ge(o,2,i,i,!0);for(var s,a=new o(5),u=new o(16),c=new o(20);e--;)s=i.times(i),i=i.times(a.plus(s.times(u.times(s).plus(c))))}return o.precision=t,o.rounding=n,x(i,t,n,!0)};p.hyperbolicTangent=p.tanh=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+7,r.rounding=1,E(n.sinh(),n.cosh(),r.precision=e,r.rounding=t)):new r(n.s)};p.inverseCosine=p.acos=function(){var e,t=this,n=t.constructor,r=t.abs().cmp(1),i=n.precision,o=n.rounding;return r!==-1?r===0?t.isNeg()?J(n,i,o):new n(0):new n(NaN):t.isZero()?J(n,i+4,o).times(.5):(n.precision=i+6,n.rounding=1,t=t.asin(),e=J(n,i+4,o).times(.5),n.precision=i,n.rounding=o,e.minus(t))};p.inverseHyperbolicCosine=p.acosh=function(){var e,t,n=this,r=n.constructor;return n.lte(1)?new r(n.eq(1)?0:NaN):n.isFinite()?(e=r.precision,t=r.rounding,r.precision=e+Math.max(Math.abs(n.e),n.sd())+4,r.rounding=1,B=!1,n=n.times(n).minus(1).sqrt().plus(n),B=!0,r.precision=e,r.rounding=t,n.ln()):new r(n)};p.inverseHyperbolicSine=p.asinh=function(){var e,t,n=this,r=n.constructor;return!n.isFinite()||n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+2*Math.max(Math.abs(n.e),n.sd())+6,r.rounding=1,B=!1,n=n.times(n).plus(1).sqrt().plus(n),B=!0,r.precision=e,r.rounding=t,n.ln())};p.inverseHyperbolicTangent=p.atanh=function(){var e,t,n,r,i=this,o=i.constructor;return i.isFinite()?i.e>=0?new o(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(e=o.precision,t=o.rounding,r=i.sd(),Math.max(r,e)<2*-i.e-1?x(new o(i),e,t,!0):(o.precision=n=r-i.e,i=E(i.plus(1),new o(1).minus(i),n+e,1),o.precision=e+4,o.rounding=1,i=i.ln(),o.precision=e,o.rounding=t,i.times(.5))):new o(NaN)};p.inverseSine=p.asin=function(){var e,t,n,r,i=this,o=i.constructor;return i.isZero()?new o(i):(t=i.abs().cmp(1),n=o.precision,r=o.rounding,t!==-1?t===0?(e=J(o,n+4,r).times(.5),e.s=i.s,e):new o(NaN):(o.precision=n+6,o.rounding=1,i=i.div(new o(1).minus(i.times(i)).sqrt().plus(1)).atan(),o.precision=n,o.rounding=r,i.times(2)))};p.inverseTangent=p.atan=function(){var e,t,n,r,i,o,s,a,u,c=this,l=c.constructor,f=l.precision,m=l.rounding;if(c.isFinite()){if(c.isZero())return new l(c);if(c.abs().eq(1)&&f+4<=tt)return s=J(l,f+4,m).times(.25),s.s=c.s,s}else{if(!c.s)return new l(NaN);if(f+4<=tt)return s=J(l,f+4,m).times(.5),s.s=c.s,s}for(l.precision=a=f+10,l.rounding=1,n=Math.min(28,a/A+2|0),e=n;e;--e)c=c.div(c.times(c).plus(1).sqrt().plus(1));for(B=!1,t=Math.ceil(a/A),r=1,u=c.times(c),s=new l(c),i=c;e!==-1;)if(i=i.times(u),o=s.minus(i.div(r+=2)),i=i.times(u),s=o.plus(i.div(r+=2)),s.d[t]!==void 0)for(e=t;s.d[e]===o.d[e]&&e--;);return n&&(s=s.times(2<<n-1)),B=!0,x(s,l.precision=f,l.rounding=m,!0)};p.isFinite=function(){return!!this.d};p.isInteger=p.isInt=function(){return!!this.d&&U(this.e/A)>this.d.length-2};p.isNaN=function(){return!this.s};p.isNegative=p.isNeg=function(){return this.s<0};p.isPositive=p.isPos=function(){return this.s>0};p.isZero=function(){return!!this.d&&this.d[0]===0};p.lessThan=p.lt=function(e){return this.cmp(e)<0};p.lessThanOrEqualTo=p.lte=function(e){return this.cmp(e)<1};p.logarithm=p.log=function(e){var t,n,r,i,o,s,a,u,c=this,l=c.constructor,f=l.precision,m=l.rounding,d=5;if(e==null)e=new l(10),t=!0;else{if(e=new l(e),n=e.d,e.s<0||!n||!n[0]||e.eq(1))return new l(NaN);t=e.eq(10)}if(n=c.d,c.s<0||!n||!n[0]||c.eq(1))return new l(n&&!n[0]?-1/0:c.s!=1?NaN:n?0:1/0);if(t)if(n.length>1)o=!0;else{for(i=n[0];i%10===0;)i/=10;o=i!==1}if(B=!1,a=f+d,s=ie(c,a),r=t?ve(l,a+10):ie(e,a),u=E(s,r,a,1),Pe(u.d,i=f,m))do if(a+=10,s=ie(c,a),r=t?ve(l,a+10):ie(e,a),u=E(s,r,a,1),!o){+V(u.d).slice(i+1,i+15)+1==1e14&&(u=x(u,f+1,0));break}while(Pe(u.d,i+=10,m));return B=!0,x(u,f,m)};p.minus=p.sub=function(e){var t,n,r,i,o,s,a,u,c,l,f,m,d=this,T=d.constructor;if(e=new T(e),!d.d||!e.d)return!d.s||!e.s?e=new T(NaN):d.d?e.s=-e.s:e=new T(e.d||d.s!==e.s?d:NaN),e;if(d.s!=e.s)return e.s=-e.s,d.plus(e);if(c=d.d,m=e.d,a=T.precision,u=T.rounding,!c[0]||!m[0]){if(m[0])e.s=-e.s;else if(c[0])e=new T(d);else return new T(u===3?-0:0);return B?x(e,a,u):e}if(n=U(e.e/A),l=U(d.e/A),c=c.slice(),o=l-n,o){for(f=o<0,f?(t=c,o=-o,s=m.length):(t=m,n=l,s=c.length),r=Math.max(Math.ceil(a/A),s)+2,o>r&&(o=r,t.length=1),t.reverse(),r=o;r--;)t.push(0);t.reverse()}else{for(r=c.length,s=m.length,f=r<s,f&&(s=r),r=0;r<s;r++)if(c[r]!=m[r]){f=c[r]<m[r];break}o=0}for(f&&(t=c,c=m,m=t,e.s=-e.s),s=c.length,r=m.length-s;r>0;--r)c[s++]=0;for(r=m.length;r>o;){if(c[--r]<m[r]){for(i=r;i&&c[--i]===0;)c[i]=X-1;--c[i],c[r]+=X}c[r]-=m[r]}for(;c[--s]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(e.d=c,e.e=Ve(c,n),B?x(e,a,u):e):new T(u===3?-0:0)};p.modulo=p.mod=function(e){var t,n=this,r=n.constructor;return e=new r(e),!n.d||!e.s||e.d&&!e.d[0]?new r(NaN):!e.d||n.d&&!n.d[0]?x(new r(n),r.precision,r.rounding):(B=!1,r.modulo==9?(t=E(n,e.abs(),0,3,1),t.s*=e.s):t=E(n,e,0,r.modulo,1),t=t.times(e),B=!0,n.minus(t))};p.naturalExponential=p.exp=function(){return nt(this)};p.naturalLogarithm=p.ln=function(){return ie(this)};p.negated=p.neg=function(){var e=new this.constructor(this);return e.s=-e.s,x(e)};p.plus=p.add=function(e){var t,n,r,i,o,s,a,u,c,l,f=this,m=f.constructor;if(e=new m(e),!f.d||!e.d)return!f.s||!e.s?e=new m(NaN):f.d||(e=new m(e.d||f.s===e.s?f:NaN)),e;if(f.s!=e.s)return e.s=-e.s,f.minus(e);if(c=f.d,l=e.d,a=m.precision,u=m.rounding,!c[0]||!l[0])return l[0]||(e=new m(f)),B?x(e,a,u):e;if(o=U(f.e/A),r=U(e.e/A),c=c.slice(),i=o-r,i){for(i<0?(n=c,i=-i,s=l.length):(n=l,r=o,s=c.length),o=Math.ceil(a/A),s=o>s?o+1:s+1,i>s&&(i=s,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(s=c.length,i=l.length,s-i<0&&(i=s,n=l,l=c,c=n),t=0;i;)t=(c[--i]=c[i]+l[i]+t)/X|0,c[i]%=X;for(t&&(c.unshift(t),++r),s=c.length;c[--s]==0;)c.pop();return e.d=c,e.e=Ve(c,r),B?x(e,a,u):e};p.precision=p.sd=function(e){var t,n=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(oe+e);return n.d?(t=Vt(n.d),e&&n.e+1>t&&(t=n.e+1)):t=NaN,t};p.round=function(){var e=this,t=e.constructor;return x(new t(e),e.e+1,t.rounding)};p.sine=p.sin=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+A,r.rounding=1,n=Bn(r,Gt(r,n)),r.precision=e,r.rounding=t,x(te>2?n.neg():n,e,t,!0)):new r(NaN)};p.squareRoot=p.sqrt=function(){var e,t,n,r,i,o,s=this,a=s.d,u=s.e,c=s.s,l=s.constructor;if(c!==1||!a||!a[0])return new l(!c||c<0&&(!a||a[0])?NaN:a?s:1/0);for(B=!1,c=Math.sqrt(+s),c==0||c==1/0?(t=V(a),(t.length+u)%2==0&&(t+="0"),c=Math.sqrt(t),u=U((u+1)/2)-(u<0||u%2),c==1/0?t="5e"+u:(t=c.toExponential(),t=t.slice(0,t.indexOf("e")+1)+u),r=new l(t)):r=new l(c.toString()),n=(u=l.precision)+3;;)if(o=r,r=o.plus(E(s,o,n+2,1)).times(.5),V(o.d).slice(0,n)===(t=V(r.d)).slice(0,n))if(t=t.slice(n-3,n+1),t=="9999"||!i&&t=="4999"){if(!i&&(x(o,u+1,0),o.times(o).eq(s))){r=o;break}n+=4,i=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(x(r,u+1,1),e=!r.times(r).eq(s));break}return B=!0,x(r,u,l.rounding,e)};p.tangent=p.tan=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+10,r.rounding=1,n=n.sin(),n.s=1,n=E(n,new r(1).minus(n.times(n)).sqrt(),e+10,0),r.precision=e,r.rounding=t,x(te==2||te==4?n.neg():n,e,t,!0)):new r(NaN)};p.times=p.mul=function(e){var t,n,r,i,o,s,a,u,c,l=this,f=l.constructor,m=l.d,d=(e=new f(e)).d;if(e.s*=l.s,!m||!m[0]||!d||!d[0])return new f(!e.s||m&&!m[0]&&!d||d&&!d[0]&&!m?NaN:!m||!d?e.s/0:e.s*0);for(n=U(l.e/A)+U(e.e/A),u=m.length,c=d.length,u<c&&(o=m,m=d,d=o,s=u,u=c,c=s),o=[],s=u+c,r=s;r--;)o.push(0);for(r=c;--r>=0;){for(t=0,i=u+r;i>r;)a=o[i]+d[r]*m[i-r-1]+t,o[i--]=a%X|0,t=a/X|0;o[i]=(o[i]+t)%X|0}for(;!o[--s];)o.pop();return t?++n:o.shift(),e.d=o,e.e=Ve(o,n),B?x(e,f.precision,f.rounding):e};p.toBinary=function(e,t){return it(this,2,e,t)};p.toDecimalPlaces=p.toDP=function(e,t){var n=this,r=n.constructor;return n=new r(n),e===void 0?n:(j(e,0,se),t===void 0?t=r.rounding:j(t,0,8),x(n,e+n.e+1,t))};p.toExponential=function(e,t){var n,r=this,i=r.constructor;return e===void 0?n=Q(r,!0):(j(e,0,se),t===void 0?t=i.rounding:j(t,0,8),r=x(new i(r),e+1,t),n=Q(r,!0,e+1)),r.isNeg()&&!r.isZero()?"-"+n:n};p.toFixed=function(e,t){var n,r,i=this,o=i.constructor;return e===void 0?n=Q(i):(j(e,0,se),t===void 0?t=o.rounding:j(t,0,8),r=x(new o(i),e+i.e+1,t),n=Q(r,!1,e+r.e+1)),i.isNeg()&&!i.isZero()?"-"+n:n};p.toFraction=function(e){var t,n,r,i,o,s,a,u,c,l,f,m,d=this,T=d.d,g=d.constructor;if(!T)return new g(d);if(c=n=new g(1),r=u=new g(0),t=new g(r),o=t.e=Vt(T)-d.e-1,s=o%A,t.d[0]=F(10,s<0?A+s:s),e==null)e=o>0?t:c;else{if(a=new g(e),!a.isInt()||a.lt(c))throw Error(oe+a);e=a.gt(t)?o>0?t:c:a}for(B=!1,a=new g(V(T)),l=g.precision,g.precision=o=T.length*A*2;f=E(a,t,0,1,1),i=n.plus(f.times(r)),i.cmp(e)!=1;)n=r,r=i,i=c,c=u.plus(f.times(i)),u=i,i=t,t=a.minus(f.times(i)),a=i;return i=E(e.minus(n),r,0,1,1),u=u.plus(i.times(c)),n=n.plus(i.times(r)),u.s=c.s=d.s,m=E(c,r,o,1).minus(d).abs().cmp(E(u,n,o,1).minus(d).abs())<1?[c,r]:[u,n],g.precision=l,B=!0,m};p.toHexadecimal=p.toHex=function(e,t){return it(this,16,e,t)};p.toNearest=function(e,t){var n=this,r=n.constructor;if(n=new r(n),e==null){if(!n.d)return n;e=new r(1),t=r.rounding}else{if(e=new r(e),t===void 0?t=r.rounding:j(t,0,8),!n.d)return e.s?n:e;if(!e.d)return e.s&&(e.s=n.s),e}return e.d[0]?(B=!1,n=E(n,e,0,t,1).times(e),B=!0,x(n)):(e.s=n.s,n=e),n};p.toNumber=function(){return+this};p.toOctal=function(e,t){return it(this,8,e,t)};p.toPower=p.pow=function(e){var t,n,r,i,o,s,a=this,u=a.constructor,c=+(e=new u(e));if(!a.d||!e.d||!a.d[0]||!e.d[0])return new u(F(+a,c));if(a=new u(a),a.eq(1))return a;if(r=u.precision,o=u.rounding,e.eq(1))return x(a,r,o);if(t=U(e.e/A),t>=e.d.length-1&&(n=c<0?-c:c)<=Pn)return i=Wt(u,a,n,r),e.s<0?new u(1).div(i):x(i,r,o);if(s=a.s,s<0){if(t<e.d.length-1)return new u(NaN);if((e.d[t]&1)==0&&(s=1),a.e==0&&a.d[0]==1&&a.d.length==1)return a.s=s,a}return n=F(+a,c),t=n==0||!isFinite(n)?U(c*(Math.log("0."+V(a.d))/Math.LN10+a.e+1)):new u(n+"").e,t>u.maxE+1||t<u.minE-1?new u(t>0?s/0:0):(B=!1,u.rounding=a.s=1,n=Math.min(12,(t+"").length),i=nt(e.times(ie(a,r+n)),r),i.d&&(i=x(i,r+5,1),Pe(i.d,r,o)&&(t=r+10,i=x(nt(e.times(ie(a,t+n)),t),t+5,1),+V(i.d).slice(r+1,r+15)+1==1e14&&(i=x(i,r+1,0)))),i.s=s,B=!0,u.rounding=o,x(i,r,o))};p.toPrecision=function(e,t){var n,r=this,i=r.constructor;return e===void 0?n=Q(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(j(e,1,se),t===void 0?t=i.rounding:j(t,0,8),r=x(new i(r),e,t),n=Q(r,e<=r.e||r.e<=i.toExpNeg,e)),r.isNeg()&&!r.isZero()?"-"+n:n};p.toSignificantDigits=p.toSD=function(e,t){var n=this,r=n.constructor;return e===void 0?(e=r.precision,t=r.rounding):(j(e,1,se),t===void 0?t=r.rounding:j(t,0,8)),x(new r(n),e,t)};p.toString=function(){var e=this,t=e.constructor,n=Q(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+n:n};p.truncated=p.trunc=function(){return x(new this.constructor(this),this.e+1,1)};p.valueOf=p.toJSON=function(){var e=this,t=e.constructor,n=Q(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+n:n};function V(e){var t,n,r,i=e.length-1,o="",s=e[0];if(i>0){for(o+=s,t=1;t<i;t++)r=e[t]+"",n=A-r.length,n&&(o+=re(n)),o+=r;s=e[t],r=s+"",n=A-r.length,n&&(o+=re(n))}else if(s===0)return"0";for(;s%10===0;)s/=10;return o+s}function j(e,t,n){if(e!==~~e||e<t||e>n)throw Error(oe+e)}function Pe(e,t,n,r){var i,o,s,a;for(o=e[0];o>=10;o/=10)--t;return--t<0?(t+=A,i=0):(i=Math.ceil((t+1)/A),t%=A),o=F(10,A-t),a=e[i]%o|0,r==null?t<3?(t==0?a=a/100|0:t==1&&(a=a/10|0),s=n<4&&a==99999||n>3&&a==49999||a==5e4||a==0):s=(n<4&&a+1==o||n>3&&a+1==o/2)&&(e[i+1]/o/100|0)==F(10,t-2)-1||(a==o/2||a==0)&&(e[i+1]/o/100|0)==0:t<4?(t==0?a=a/1e3|0:t==1?a=a/100|0:t==2&&(a=a/10|0),s=(r||n<4)&&a==9999||!r&&n>3&&a==4999):s=((r||n<4)&&a+1==o||!r&&n>3&&a+1==o/2)&&(e[i+1]/o/1e3|0)==F(10,t-3)-1,s}function Oe(e,t,n){for(var r,i=[0],o,s=0,a=e.length;s<a;){for(o=i.length;o--;)i[o]*=t;for(i[0]+=$e.indexOf(e.charAt(s++)),r=0;r<i.length;r++)i[r]>n-1&&(i[r+1]===void 0&&(i[r+1]=0),i[r+1]+=i[r]/n|0,i[r]%=n)}return i.reverse()}function An(e,t){var n,r,i;if(t.isZero())return t;r=t.d.length,r<32?(n=Math.ceil(r/3),i=(1/We(4,n)).toString()):(n=16,i="2.3283064365386962890625e-10"),e.precision+=n,t=ge(e,1,t.times(i),new e(1));for(var o=n;o--;){var s=t.times(t);t=s.times(s).minus(s).times(8).plus(1)}return e.precision-=n,t}var E=function(){function e(r,i,o){var s,a=0,u=r.length;for(r=r.slice();u--;)s=r[u]*i+a,r[u]=s%o|0,a=s/o|0;return a&&r.unshift(a),r}function t(r,i,o,s){var a,u;if(o!=s)u=o>s?1:-1;else for(a=u=0;a<o;a++)if(r[a]!=i[a]){u=r[a]>i[a]?1:-1;break}return u}function n(r,i,o,s){for(var a=0;o--;)r[o]-=a,a=r[o]<i[o]?1:0,r[o]=a*s+r[o]-i[o];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,o,s,a,u){var c,l,f,m,d,T,g,P,w,y,h,b,L,S,_,k,M,W,v,Z,ue=r.constructor,me=r.s==i.s?1:-1,K=r.d,D=i.d;if(!K||!K[0]||!D||!D[0])return new ue(!r.s||!i.s||(K?D&&K[0]==D[0]:!D)?NaN:K&&K[0]==0||!D?me*0:me/0);for(u?(d=1,l=r.e-i.e):(u=X,d=A,l=U(r.e/d)-U(i.e/d)),v=D.length,M=K.length,w=new ue(me),y=w.d=[],f=0;D[f]==(K[f]||0);f++);if(D[f]>(K[f]||0)&&l--,o==null?(S=o=ue.precision,s=ue.rounding):a?S=o+(r.e-i.e)+1:S=o,S<0)y.push(1),T=!0;else{if(S=S/d+2|0,f=0,v==1){for(m=0,D=D[0],S++;(f<M||m)&&S--;f++)_=m*u+(K[f]||0),y[f]=_/D|0,m=_%D|0;T=m||f<M}else{for(m=u/(D[0]+1)|0,m>1&&(D=e(D,m,u),K=e(K,m,u),v=D.length,M=K.length),k=v,h=K.slice(0,v),b=h.length;b<v;)h[b++]=0;Z=D.slice(),Z.unshift(0),W=D[0],D[1]>=u/2&&++W;do m=0,c=t(D,h,v,b),c<0?(L=h[0],v!=b&&(L=L*u+(h[1]||0)),m=L/W|0,m>1?(m>=u&&(m=u-1),g=e(D,m,u),P=g.length,b=h.length,c=t(g,h,P,b),c==1&&(m--,n(g,v<P?Z:D,P,u))):(m==0&&(c=m=1),g=D.slice()),P=g.length,P<b&&g.unshift(0),n(h,g,b,u),c==-1&&(b=h.length,c=t(D,h,v,b),c<1&&(m++,n(h,v<b?Z:D,b,u))),b=h.length):c===0&&(m++,h=[0]),y[f++]=m,c&&h[0]?h[b++]=K[k]||0:(h=[K[k]],b=1);while((k++<M||h[0]!==void 0)&&S--);T=h[0]!==void 0}y[0]||y.shift()}if(d==1)w.e=l,Ot=T;else{for(f=1,m=y[0];m>=10;m/=10)f++;w.e=f+l*d-1,x(w,a?o+w.e+1:o,s,T)}return w}}();function x(e,t,n,r){var i,o,s,a,u,c,l,f,m,d=e.constructor;e:if(t!=null){if(f=e.d,!f)return e;for(i=1,a=f[0];a>=10;a/=10)i++;if(o=t-i,o<0)o+=A,s=t,l=f[m=0],u=l/F(10,i-s-1)%10|0;else if(m=Math.ceil((o+1)/A),a=f.length,m>=a)if(r){for(;a++<=m;)f.push(0);l=u=0,i=1,o%=A,s=o-A+1}else break e;else{for(l=a=f[m],i=1;a>=10;a/=10)i++;o%=A,s=o-A+i,u=s<0?0:l/F(10,i-s-1)%10|0}if(r=r||t<0||f[m+1]!==void 0||(s<0?l:l%F(10,i-s-1)),c=n<4?(u||r)&&(n==0||n==(e.s<0?3:2)):u>5||u==5&&(n==4||r||n==6&&(o>0?s>0?l/F(10,i-s):0:f[m-1])%10&1||n==(e.s<0?8:7)),t<1||!f[0])return f.length=0,c?(t-=e.e+1,f[0]=F(10,(A-t%A)%A),e.e=-t||0):f[0]=e.e=0,e;if(o==0?(f.length=m,a=1,m--):(f.length=m+1,a=F(10,A-o),f[m]=s>0?(l/F(10,i-s)%F(10,s)|0)*a:0),c)for(;;)if(m==0){for(o=1,s=f[0];s>=10;s/=10)o++;for(s=f[0]+=a,a=1;s>=10;s/=10)a++;o!=a&&(e.e++,f[0]==X&&(f[0]=1));break}else{if(f[m]+=a,f[m]!=X)break;f[m--]=0,a=1}for(o=f.length;f[--o]===0;)f.pop()}return B&&(e.e>d.maxE?(e.d=null,e.e=NaN):e.e<d.minE&&(e.e=0,e.d=[0])),e}function Q(e,t,n){if(!e.isFinite())return qt(e);var r,i=e.e,o=V(e.d),s=o.length;return t?(n&&(r=n-s)>0?o=o.charAt(0)+"."+o.slice(1)+re(r):s>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(e.e<0?"e":"e+")+e.e):i<0?(o="0."+re(-i-1)+o,n&&(r=n-s)>0&&(o+=re(r))):i>=s?(o+=re(i+1-s),n&&(r=n-i-1)>0&&(o=o+"."+re(r))):((r=i+1)<s&&(o=o.slice(0,r)+"."+o.slice(r)),n&&(r=n-s)>0&&(i+1===s&&(o+="."),o+=re(r))),o}function Ve(e,t){var n=e[0];for(t*=A;n>=10;n/=10)t++;return t}function ve(e,t,n){if(t>xn)throw B=!0,n&&(e.precision=n),Error(_t);return x(new e(_e),t,1,!0)}function J(e,t,n){if(t>tt)throw Error(_t);return x(new e(Fe),t,n,!0)}function Vt(e){var t=e.length-1,n=t*A+1;if(t=e[t],t){for(;t%10==0;t/=10)n--;for(t=e[0];t>=10;t/=10)n++}return n}function re(e){for(var t="";e--;)t+="0";return t}function Wt(e,t,n,r){var i,o=new e(1),s=Math.ceil(r/A+4);for(B=!1;;){if(n%2&&(o=o.times(t),Mt(o.d,s)&&(i=!0)),n=U(n/2),n===0){n=o.d.length-1,i&&o.d[n]===0&&++o.d[n];break}t=t.times(t),Mt(t.d,s)}return B=!0,o}function Dt(e){return e.d[e.d.length-1]&1}function Ut(e,t,n){for(var r,i=new e(t[0]),o=0;++o<t.length;)if(r=new e(t[o]),r.s)i[n](r)&&(i=r);else{i=r;break}return i}function nt(e,t){var n,r,i,o,s,a,u,c=0,l=0,f=0,m=e.constructor,d=m.rounding,T=m.precision;if(!e.d||!e.d[0]||e.e>17)return new m(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:0/0);for(t==null?(B=!1,u=T):u=t,a=new m(.03125);e.e>-2;)e=e.times(a),f+=5;for(r=Math.log(F(2,f))/Math.LN10*2+5|0,u+=r,n=o=s=new m(1),m.precision=u;;){if(o=x(o.times(e),u,1),n=n.times(++l),a=s.plus(E(o,n,u,1)),V(a.d).slice(0,u)===V(s.d).slice(0,u)){for(i=f;i--;)s=x(s.times(s),u,1);if(t==null)if(c<3&&Pe(s.d,u-r,d,c))m.precision=u+=10,n=o=a=new m(1),l=0,c++;else return x(s,m.precision=T,d,B=!0);else return m.precision=T,s}s=a}}function ie(e,t){var n,r,i,o,s,a,u,c,l,f,m,d=1,T=10,g=e,P=g.d,w=g.constructor,y=w.rounding,h=w.precision;if(g.s<0||!P||!P[0]||!g.e&&P[0]==1&&P.length==1)return new w(P&&!P[0]?-1/0:g.s!=1?NaN:P?0:g);if(t==null?(B=!1,l=h):l=t,w.precision=l+=T,n=V(P),r=n.charAt(0),Math.abs(o=g.e)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)g=g.times(e),n=V(g.d),r=n.charAt(0),d++;o=g.e,r>1?(g=new w("0."+n),o++):g=new w(r+"."+n.slice(1))}else return c=ve(w,l+2,h).times(o+""),g=ie(new w(r+"."+n.slice(1)),l-T).plus(c),w.precision=h,t==null?x(g,h,y,B=!0):g;for(f=g,u=s=g=E(g.minus(1),g.plus(1),l,1),m=x(g.times(g),l,1),i=3;;){if(s=x(s.times(m),l,1),c=u.plus(E(s,new w(i),l,1)),V(c.d).slice(0,l)===V(u.d).slice(0,l))if(u=u.times(2),o!==0&&(u=u.plus(ve(w,l+2,h).times(o+""))),u=E(u,new w(d),l,1),t==null)if(Pe(u.d,l-T,y,a))w.precision=l+=T,c=s=g=E(f.minus(1),f.plus(1),l,1),m=x(g.times(g),l,1),i=a=1;else return x(u,w.precision=h,y,B=!0);else return w.precision=h,u;u=c,i+=2}}function qt(e){return String(e.s*e.s/0)}function rt(e,t){var n,r,i;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;t.charCodeAt(r)===48;r++);for(i=t.length;t.charCodeAt(i-1)===48;--i);if(t=t.slice(r,i),t){if(i-=r,e.e=n=n-r-1,e.d=[],r=(n+1)%A,n<0&&(r+=A),r<i){for(r&&e.d.push(+t.slice(0,r)),i-=A;r<i;)e.d.push(+t.slice(r,r+=A));t=t.slice(r),r=A-t.length}else r-=i;for(;r--;)t+="0";e.d.push(+t),B&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function Sn(e,t){var n,r,i,o,s,a,u,c,l;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),Kt.test(t))return rt(e,t)}else if(t==="Infinity"||t==="NaN")return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(wn.test(t))n=16,t=t.toLowerCase();else if(yn.test(t))n=2;else if(Tn.test(t))n=8;else throw Error(oe+t);for(o=t.search(/p/i),o>0?(u=+t.slice(o+1),t=t.substring(2,o)):t=t.slice(2),o=t.indexOf("."),s=o>=0,r=e.constructor,s&&(t=t.replace(".",""),a=t.length,o=a-o,i=Wt(r,new r(n),o,o*2)),c=Oe(t,n,X),l=c.length-1,o=l;c[o]===0;--o)c.pop();return o<0?new r(e.s*0):(e.e=Ve(c,l),e.d=c,B=!1,s&&(e=E(e,i,a*4)),u&&(e=e.times(Math.abs(u)<54?F(2,u):Ue.pow(2,u))),B=!0,e)}function Bn(e,t){var n,r=t.d.length;if(r<3)return t.isZero()?t:ge(e,2,t,t);n=1.4*Math.sqrt(r),n=n>16?16:n|0,t=t.times(1/We(5,n)),t=ge(e,2,t,t);for(var i,o=new e(5),s=new e(16),a=new e(20);n--;)i=t.times(t),t=t.times(o.plus(i.times(s.times(i).minus(a))));return t}function ge(e,t,n,r,i){var o,s,a,u,c=1,l=e.precision,f=Math.ceil(l/A);for(B=!1,u=n.times(n),a=new e(r);;){if(s=E(a.times(u),new e(t++*t++),l,1),a=i?r.plus(s):r.minus(s),r=E(s.times(u),new e(t++*t++),l,1),s=a.plus(r),s.d[f]!==void 0){for(o=f;s.d[o]===a.d[o]&&o--;);if(o==-1)break}o=a,a=r,r=s,s=o,c++}return B=!0,s.d.length=f+1,s}function We(e,t){for(var n=e;--t;)n*=e;return n}function Gt(e,t){var n,r=t.s<0,i=J(e,e.precision,1),o=i.times(.5);if(t=t.abs(),t.lte(o))return te=r?4:1,t;if(n=t.divToInt(i),n.isZero())te=r?3:2;else{if(t=t.minus(n.times(i)),t.lte(o))return te=Dt(n)?r?2:3:r?4:1,t;te=Dt(n)?r?1:4:r?3:2}return t.minus(i).abs()}function it(e,t,n,r){var i,o,s,a,u,c,l,f,m,d=e.constructor,T=n!==void 0;if(T?(j(n,1,se),r===void 0?r=d.rounding:j(r,0,8)):(n=d.precision,r=d.rounding),!e.isFinite())l=qt(e);else{for(l=Q(e),s=l.indexOf("."),T?(i=2,t==16?n=n*4-3:t==8&&(n=n*3-2)):i=t,s>=0&&(l=l.replace(".",""),m=new d(1),m.e=l.length-s,m.d=Oe(Q(m),10,i),m.e=m.d.length),f=Oe(l,10,i),o=u=f.length;f[--u]==0;)f.pop();if(!f[0])l=T?"0p+0":"0";else{if(s<0?o--:(e=new d(e),e.d=f,e.e=o,e=E(e,m,n,r,0,i),f=e.d,o=e.e,c=Ot),s=f[n],a=i/2,c=c||f[n+1]!==void 0,c=r<4?(s!==void 0||c)&&(r===0||r===(e.s<0?3:2)):s>a||s===a&&(r===4||c||r===6&&f[n-1]&1||r===(e.s<0?8:7)),f.length=n,c)for(;++f[--n]>i-1;)f[n]=0,n||(++o,f.unshift(1));for(u=f.length;!f[u-1];--u);for(s=0,l="";s<u;s++)l+=$e.charAt(f[s]);if(T){if(u>1)if(t==16||t==8){for(s=t==16?4:3,--u;u%s;u++)l+="0";for(f=Oe(l,i,t),u=f.length;!f[u-1];--u);for(s=1,l="1.";s<u;s++)l+=$e.charAt(f[s])}else l=l.charAt(0)+"."+l.slice(1);l=l+(o<0?"p":"p+")+o}else if(o<0){for(;++o;)l="0"+l;l="0."+l}else if(++o>u)for(o-=u;o--;)l+="0";else o<u&&(l=l.slice(0,o)+"."+l.slice(o))}l=(t==16?"0x":t==2?"0b":t==8?"0o":"")+l}return e.s<0?"-"+l:l}function Mt(e,t){if(e.length>t)return e.length=t,!0}function kn(e){return new this(e).abs()}function Ln(e){return new this(e).acos()}function Cn(e){return new this(e).acosh()}function Nn(e,t){return new this(e).plus(t)}function In(e){return new this(e).asin()}function En(e){return new this(e).asinh()}function Dn(e){return new this(e).atan()}function Mn(e){return new this(e).atanh()}function Rn(e,t){e=new this(e),t=new this(t);var n,r=this.precision,i=this.rounding,o=r+4;return!e.s||!t.s?n=new this(NaN):!e.d&&!t.d?(n=J(this,o,1).times(t.s>0?.25:.75),n.s=e.s):!t.d||e.isZero()?(n=t.s<0?J(this,r,i):new this(0),n.s=e.s):!e.d||t.isZero()?(n=J(this,o,1).times(.5),n.s=e.s):t.s<0?(this.precision=o,this.rounding=1,n=this.atan(E(e,t,o,1)),t=J(this,o,1),this.precision=r,this.rounding=i,n=e.s<0?n.minus(t):n.plus(t)):n=this.atan(E(e,t,o,1)),n}function On(e){return new this(e).cbrt()}function _n(e){return x(e=new this(e),e.e+1,2)}function Fn(e,t,n){return new this(e).clamp(t,n)}function vn(e){if(!e||typeof e!="object")throw Error(Ke+"Object expected");var t,n,r,i=e.defaults===!0,o=["precision",1,se,"rounding",0,8,"toExpNeg",-pe,0,"toExpPos",0,pe,"maxE",0,pe,"minE",-pe,0,"modulo",0,9];for(t=0;t<o.length;t+=3)if(n=o[t],i&&(this[n]=et[n]),(r=e[n])!==void 0)if(U(r)===r&&r>=o[t+1]&&r<=o[t+2])this[n]=r;else throw Error(oe+n+": "+r);if(n="crypto",i&&(this[n]=et[n]),(r=e[n])!==void 0)if(r===!0||r===!1||r===0||r===1)if(r)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[n]=!0;else throw Error(Ft);else this[n]=!1;else throw Error(oe+n+": "+r);return this}function Kn(e){return new this(e).cos()}function Vn(e){return new this(e).cosh()}function Ht(e){var t,n,r;function i(o){var s,a,u,c=this;if(!(c instanceof i))return new i(o);if(c.constructor=i,Rt(o)){c.s=o.s,B?!o.d||o.e>i.maxE?(c.e=NaN,c.d=null):o.e<i.minE?(c.e=0,c.d=[0]):(c.e=o.e,c.d=o.d.slice()):(c.e=o.e,c.d=o.d?o.d.slice():o.d);return}if(u=typeof o,u==="number"){if(o===0){c.s=1/o<0?-1:1,c.e=0,c.d=[0];return}if(o<0?(o=-o,c.s=-1):c.s=1,o===~~o&&o<1e7){for(s=0,a=o;a>=10;a/=10)s++;B?s>i.maxE?(c.e=NaN,c.d=null):s<i.minE?(c.e=0,c.d=[0]):(c.e=s,c.d=[o]):(c.e=s,c.d=[o]);return}else if(o*0!==0){o||(c.s=NaN),c.e=NaN,c.d=null;return}return rt(c,o.toString())}else if(u!=="string")throw Error(oe+o);return(a=o.charCodeAt(0))===45?(o=o.slice(1),c.s=-1):(a===43&&(o=o.slice(1)),c.s=1),Kt.test(o)?rt(c,o):Sn(c,o)}if(i.prototype=p,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=vn,i.clone=Ht,i.isDecimal=Rt,i.abs=kn,i.acos=Ln,i.acosh=Cn,i.add=Nn,i.asin=In,i.asinh=En,i.atan=Dn,i.atanh=Mn,i.atan2=Rn,i.cbrt=On,i.ceil=_n,i.clamp=Fn,i.cos=Kn,i.cosh=Vn,i.div=Wn,i.exp=Un,i.floor=qn,i.hypot=Gn,i.ln=Hn,i.log=jn,i.log10=Yn,i.log2=zn,i.max=Zn,i.min=Jn,i.mod=Xn,i.mul=Qn,i.pow=$n,i.random=er,i.round=tr,i.sign=nr,i.sin=rr,i.sinh=ir,i.sqrt=or,i.sub=sr,i.sum=ar,i.tan=ur,i.tanh=cr,i.trunc=lr,e===void 0&&(e={}),e&&e.defaults!==!0)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],t=0;t<r.length;)e.hasOwnProperty(n=r[t++])||(e[n]=this[n]);return i.config(e),i}function Wn(e,t){return new this(e).div(t)}function Un(e){return new this(e).exp()}function qn(e){return x(e=new this(e),e.e+1,3)}function Gn(){var e,t,n=new this(0);for(B=!1,e=0;e<arguments.length;)if(t=new this(arguments[e++]),t.d)n.d&&(n=n.plus(t.times(t)));else{if(t.s)return B=!0,new this(1/0);n=t}return B=!0,n.sqrt()}function Rt(e){return e instanceof Ue||e&&e.toStringTag===vt||!1}function Hn(e){return new this(e).ln()}function jn(e,t){return new this(e).log(t)}function zn(e){return new this(e).log(2)}function Yn(e){return new this(e).log(10)}function Zn(){return Ut(this,arguments,"lt")}function Jn(){return Ut(this,arguments,"gt")}function Xn(e,t){return new this(e).mod(t)}function Qn(e,t){return new this(e).mul(t)}function $n(e,t){return new this(e).pow(t)}function er(e){var t,n,r,i,o=0,s=new this(1),a=[];if(e===void 0?e=this.precision:j(e,1,se),r=Math.ceil(e/A),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(r));o<r;)i=t[o],i>=429e7?t[o]=crypto.getRandomValues(new Uint32Array(1))[0]:a[o++]=i%1e7;else if(crypto.randomBytes){for(t=crypto.randomBytes(r*=4);o<r;)i=t[o]+(t[o+1]<<8)+(t[o+2]<<16)+((t[o+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(t,o):(a.push(i%1e7),o+=4);o=r/4}else throw Error(Ft);else for(;o<r;)a[o++]=Math.random()*1e7|0;for(r=a[--o],e%=A,r&&e&&(i=F(10,A-e),a[o]=(r/i|0)*i);a[o]===0;o--)a.pop();if(o<0)n=0,a=[0];else{for(n=-1;a[0]===0;n-=A)a.shift();for(r=1,i=a[0];i>=10;i/=10)r++;r<A&&(n-=A-r)}return s.e=n,s.d=a,s}function tr(e){return x(e=new this(e),e.e+1,this.rounding)}function nr(e){return e=new this(e),e.d?e.d[0]?e.s:0*e.s:e.s||NaN}function rr(e){return new this(e).sin()}function ir(e){return new this(e).sinh()}function or(e){return new this(e).sqrt()}function sr(e,t){return new this(e).sub(t)}function ar(){var e=0,t=arguments,n=new this(t[e]);for(B=!1;n.s&&++e<t.length;)n=n.plus(t[e]);return B=!0,x(n,this.precision,this.rounding)}function ur(e){return new this(e).tan()}function cr(e){return new this(e).tanh()}function lr(e){return x(e=new this(e),e.e+1,1)}p[Symbol.for("nodejs.util.inspect.custom")]=p.toString;p[Symbol.toStringTag]="Decimal";var Ue=p.constructor=Ht(et);_e=new Ue(_e);Fe=new Ue(Fe);import{PublicKey as at}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as fr}from"@solana/spl-token";import{PublicKey as O,SystemProgram as jt,SYSVAR_RENT_PUBKEY as mr}from"@solana/web3.js";function ot({pubkey:e,isSigner:t=!1,isWritable:n=!0}){return{pubkey:e,isWritable:n,isSigner:t}}var ri=[ot({pubkey:fr,isWritable:!1}),ot({pubkey:jt.programId,isWritable:!1}),ot({pubkey:mr,isWritable:!1})];function zt({publicKey:e,transformSol:t}){let n=Yt(e.toString());if(n instanceof O)return t&&n.equals(xe)?st:n;if(t&&n.toString()===xe.toBase58())return st;if(typeof n=="string"){if(n===O.default.toBase58())return O.default;try{return new O(n)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function Yt(e){try{return new O(e)}catch{return e}}var ii=new O("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),oi=new O("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),si=new O("SysvarRent111111111111111111111111111111111"),ai=new O("SysvarC1ock11111111111111111111111111111111"),ui=new O("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),ci=new O("Sysvar1nstructions1111111111111111111111111"),li=jt.programId,fi=new O("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),mi=new O("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),di=new O("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),pi=new O("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),gi=new O("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),hi=new O("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),bi=new O("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),yi=new O("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),wi=new O("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),Ti=new O("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),Pi=new O("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),st=new O("So11111111111111111111111111111111111111112"),xe=O.default;import{PublicKey as dr}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Zt}from"@solana/spl-token";var Jt={chainId:101,address:dr.default.toBase58(),programId:Zt.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},le={chainId:101,address:"So11111111111111111111111111111111111111112",programId:Zt.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};var ut=class{constructor({mint:t,decimals:n,symbol:r,name:i,skipMint:o=!1,isToken2022:s=!1}){if(t===xe.toBase58()||t instanceof at&&xe.equals(t)){this.decimals=le.decimals,this.symbol=le.symbol,this.name=le.name,this.mint=new at(le.address),this.isToken2022=!1;return}this.decimals=n,this.symbol=r||t.toString().substring(0,6),this.name=i||t.toString().substring(0,6),this.mint=o?at.default:zt({publicKey:t}),this.isToken2022=s}equals(t){return this===t?!0:this.mint.equals(t.mint)}},Y=ut;Y.WSOL=new ut(ne(G({},le),{mint:le.address}));import Ge from"big.js";import hr from"bn.js";import br from"decimal.js-light";import pr from"toformat";var gr=pr,Ae=gr;var qe=H("module/fraction"),ct=Ae(Ge),Se=Ae(br),yr={[0]:Se.ROUND_DOWN,[1]:Se.ROUND_HALF_UP,[2]:Se.ROUND_UP},wr={[0]:Ge.roundDown,[1]:Ge.roundHalfUp,[2]:Ge.roundUp},R=class{constructor(t,n=new hr(1)){this.numerator=ae(t),this.denominator=ae(n)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new R(this.denominator,this.numerator)}add(t){let n=t instanceof R?t:new R(ae(t));return this.denominator.eq(n.denominator)?new R(this.numerator.add(n.numerator),this.denominator):new R(this.numerator.mul(n.denominator).add(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}sub(t){let n=t instanceof R?t:new R(ae(t));return this.denominator.eq(n.denominator)?new R(this.numerator.sub(n.numerator),this.denominator):new R(this.numerator.mul(n.denominator).sub(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}mul(t){let n=t instanceof R?t:new R(ae(t));return new R(this.numerator.mul(n.numerator),this.denominator.mul(n.denominator))}div(t){let n=t instanceof R?t:new R(ae(t));return new R(this.numerator.mul(n.denominator),this.denominator.mul(n.numerator))}toSignificant(t,n={groupSeparator:""},r=1){Number.isInteger(t)||qe.logWithError(`${t} is not an integer.`),t<=0&&qe.logWithError(`${t} is not positive.`),Se.set({precision:t+1,rounding:yr[r]});let i=new Se(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(t);return i.toFormat(i.decimalPlaces(),n)}toFixed(t,n={groupSeparator:""},r=1){return Number.isInteger(t)||qe.logWithError(`${t} is not an integer.`),t<0&&qe.logWithError(`${t} is negative.`),ct.DP=t,ct.RM=wr[r]||1,new ct(this.numerator.toString()).div(this.denominator.toString()).toFormat(t,n)}isZero(){return this.numerator.isZero()}};var zi=H("Raydium_price");var lt=class{constructor({decimals:t,symbol:n="UNKNOWN",name:r="UNKNOWN"}){this.decimals=t,this.symbol=n,this.name=r}equals(t){return this===t}},He=lt;He.SOL=new lt(Jt);import Pr from"bn.js";var to=new R(new Pr(100));var xr=new z(0),xo=new z(1),Ao=new z(2),So=new z(3),Bo=new z(5),Ar=new z(10),ko=new z(100),Lo=new z(1e3),Co=new z(1e4),en=9007199254740991;function ae(e){let t=H("Raydium_parseBigNumberish");if(e instanceof z)return e;if(typeof e=="string"){if(e.match(/^-?[0-9]+$/))return new z(e);t.logWithError(`invalid BigNumberish string: ${e}`)}return typeof e=="number"?(e%1&&t.logWithError(`BigNumberish number underflow: ${e}`),(e>=en||e<=-en)&&t.logWithError(`BigNumberish number overflow: ${e}`),new z(String(e))):typeof e=="bigint"?new z(e.toString()):(t.error(`invalid BigNumberish value: ${e}`),new z(0))}var Uo=H("Raydium_amount"),qo=Ae(Sr);function ft(e,t=1,n=[]){let r=[...e];if(t<=0)return n;for(;r.length;)n.push(r.splice(0,t));return n}import{PublicKey as C}from"@solana/web3.js";var ls=new C("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),fs=new C("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),ms=new C("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),ds=new C("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),ps=new C("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),gs=new C("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),hs=new C("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),bs=new C("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),ys=new C("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),ws=new C("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),Ts=new C("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),Ps=new C("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),xs=new C("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),As=new C("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),Ss=new C("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),Bs=new C("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),ks=new C("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),Ls=new C("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),Cs=new C("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),Br=new C("CPMDWBwJDtYax9qW7AyRuVC19Cc4L4Vcy4n2BHAbHkCW"),kr=new C("7rQ1QFNosMkUCuh7Z7fPbTHvh73b68sQYdirycEzJVuw"),Lr=new C("G11FKBRaAkHAKuLCgLM6K6NUc9rTjPAznRCjZifrTQe2");var Ns={SERUM_MARKET:C.default,OPENBOOK_MARKET:new C("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),UTIL1216:C.default,FarmV3:new C("85BFyr98MbCUU9MVTEgzx1nbhWACbJqLzho6zd6DZcWL"),FarmV5:new C("EcLzTrNg9V7qhcdyXDe2qjtPkiGzDM2UbdRaeaadU5r2"),FarmV6:new C("Farm2hJLcqPtPg8M4rR6DMrsRNc5TPm5Cs4bVQrMe2T7"),AmmV4:new C("HWy1jotHpo6UqeQxx49dpYYdQB8wj9Qk9MdxwjLvDHB8"),AmmStable:new C("DDg4VmQaJV9ogWce7LpcjBA9bv22wRp5uaTPa5pGjijF"),CLMM:new C("devi51mZmdwUJGU9hjN27vEz64Gps7uUefqxg27EAtH"),Router:new C("BVChZ3XFEwTMUk1o9i3HAf91H6mFxSwa5X2wFAWhYPhU"),CREATE_CPMM_POOL_PROGRAM:Br,CREATE_CPMM_POOL_AUTH:kr,CREATE_CPMM_POOL_FEE_ACC:Lr,FEE_DESTINATION_ID:new C("3XMrhbv989VxAMi3DErLV9eJht1pHppW5LbKxe9fkEFR")};import{PublicKey as Ds}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Os}from"@solana/spl-token";import vs from"bn.js";var mt=H("Raydium_accountInfo_util");async function je(e,t,n){let{batchRequest:r,commitment:i="confirmed",chunkCount:o=100}=G({batchRequest:!1},n),s=ft(t,o),a=new Array(s.length).fill([]);if(r){let u=s.map(f=>{let m=e._buildArgs([f.map(d=>d.toBase58())],i,"base64");return{methodName:"getMultipleAccounts",args:m}}),c=ft(u,10);a=(await(await Promise.all(c.map(async f=>await e._rpcBatchRequest(f)))).flat()).map(f=>(f.error&&mt.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${f.error.message}`),f.result.value.map(m=>{if(m){let{data:d,executable:T,lamports:g,owner:P,rentEpoch:w}=m;return d.length!==2&&d[1]!=="base64"&&mt.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(d[0],"base64"),executable:T,lamports:g,owner:new Cr(P),rentEpoch:w}}return null})))}else try{a=await Promise.all(s.map(u=>e.getMultipleAccountsInfo(u,i)))}catch(u){u instanceof Error&&mt.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${u.message}`)}return a.flat()}async function dt({connection:e,address:t}){let n=await je(e,[...new Set(t.map(i=>i.toString()))].map(i=>new tn(i))),r={};for(let i=0;i<t.length;i++){let o=n[i],s=t[i];if(!o)continue;let a=new ze({key:s,state:ze.deserialize(o.data)});r[s.toString()]=a,Ye[s.toString()]=a}return r}var Ye={"2immgwYNHBbyVQKVGCEkgWpi53bLwWNRMB5G2nbgYV17":new ze({key:new tn("2immgwYNHBbyVQKVGCEkgWpi53bLwWNRMB5G2nbgYV17"),state:ze.deserialize(Buffer.from("AQAAAP//////////d49+DAAAAAAAAQZMWvw7GUNJdaccNBVnb57OKakxL2BHLYvhRwVILRsgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMGRm/lIRcy/+ytunLDm+e8jOW7xfcSayxDmzpAAAAABt324ddloZPZy+FGzut5rBy0he1fWzeROoz1hX7/AKkG3fbh7nWP3hhCXbzkbM3athr8TYO5DSf+vfko2KGL/AVKU1D4XciC1hSlVnJ4iilt3x6rq9CmBniISTL07vagBqfVFxksXFEhjMlMPUrxf1ja7gibof1E49vZigAAAAAGp9UXGMd0yShWY5hpHV62i164o5tLbVxzVVshAAAAAIyXJY9OJInxuz0QKRSODYMLWhOZ2v8QhASOe9jb6fhZC3BlsePRfEU4nVJ/awTDzVi4bHMaoP21SbbRvAP4KUbIScv+6Yw2LHF/6K0ZjUPibbSWXCirYPGuuVl7zT789IUPLW4CpHr4JNCatp3ELXDLKMv6JJ+37le50lbBJ2LvDQdRqCgtphMF/imcN7mY5YRx2xE1A3MQ+L4QRaYK9u4GRfZP3LsAd00a+IkCpA22UNQMKdq5BFbJuwuOLqc8zxCTDlqxBG8J0HcxtfogQHDK06ukzfaXiNDKAob1MqBHS9lJxDYCwz8gd5DtFqNSTKG5l1zxIaKpDP/sffi2is1H9aKveyXSu5StXElYRl9SD5As0DHE4N0GLnf84/siiKXVyp4Ez121kLcUui/jLLFZEz/BwZK3Ilf9B9OcsEAeDMKAy2vjGSxQODgBz0QwGA+eP4ZjIjrIAQaXENv31QfLlOdXSRCkaybRniDHF4C8YcwhcvsqrOVuTP4B2Na+9wLdtrB31uz2rtlFI5kahdsnp/d1SrASDInYCtTYtdoke4kX+hoKWcEWM4Tle8pTUkUVv4BxS6fje/EzKBE4Qu9N9LMnrw/JNO0hqMVB4rk/2ou4AB1loQ7FZoPwut2o4KZB+0p9xnbrQKw038qjpHar+PyDwvxBRcu5hpHw3dguezeWv+IwvgW5icu8EGkhGa9AkFPPJT7VMSFb8xowveU=","base64"))})};var Ze=class{constructor(t){this.instructions=[];this.endInstructions=[];this.lookupTableAddress=[];this.signers=[];this.instructionTypes=[];this.endInstructionTypes=[];this.connection=t.connection,this.feePayer=t.feePayer,this.signAllTransactions=t.signAllTransactions,this.owner=t.owner,this.cluster=t.cluster,this.blockhashCommitment=t.blockhashCommitment,this.api=t.api}get AllTxData(){return{instructions:this.instructions,endInstructions:this.endInstructions,signers:this.signers,instructionTypes:this.instructionTypes,endInstructionTypes:this.endInstructionTypes,lookupTableAddress:this.lookupTableAddress}}get allInstructions(){return[...this.instructions,...this.endInstructions]}async getComputeBudgetConfig(){var r;let t=(await Nr.get(`https://solanacompass.com/api/fees?cacheFreshTime=${3e5}`)).data,{avg:n}=(r=t==null?void 0:t[15])!=null?r:{};if(!!n)return{units:6e5,microLamports:Math.min(Math.ceil(n*1e6/6e5),25e3)}}addCustomComputeBudget(t){if(t){let{instructions:n,instructionTypes:r}=Me(t);return this.instructions.unshift(...n),this.instructionTypes.unshift(...r),!0}return!1}async calComputeBudget({config:t,defaultIns:n}){try{let r=t||await this.getComputeBudgetConfig();if(this.addCustomComputeBudget(r))return;n&&this.instructions.unshift(...n)}catch{n&&this.instructions.unshift(...n)}}addInstruction({instructions:t=[],endInstructions:n=[],signers:r=[],instructionTypes:i=[],endInstructionTypes:o=[],lookupTableAddress:s=[]}){return this.instructions.push(...t),this.endInstructions.push(...n),this.signers.push(...r),this.instructionTypes.push(...i),this.endInstructionTypes.push(...o),this.lookupTableAddress.push(...s.filter(a=>a!==Be.default.toString())),this}async versionBuild({txVersion:t,extInfo:n}){return t===0?await this.buildV0(G({},n||{})):this.build(n)}build(t){var r;let n=new ke;return this.allInstructions.length&&n.add(...this.allInstructions),n.feePayer=this.feePayer,((r=this.owner)==null?void 0:r.signer)&&!this.signers.some(i=>i.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer),{builder:this,transaction:n,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async i=>{var c;let{recentBlockHash:o,skipPreflight:s=!0,sendAndConfirm:a}=i||{},u=o!=null?o:await de(this.connection,this.blockhashCommitment);if(n.recentBlockhash=u,this.signers.length&&n.sign(...this.signers),ce([n]),(c=this.owner)!=null&&c.isKeyPair)return{txId:a?await pt(this.connection,n,this.signers.find(f=>f.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:s}):await this.connection.sendRawTransaction(n.serialize(),{skipPreflight:s}),signedTx:n};if(this.signAllTransactions){let l=await this.signAllTransactions([n]);return{txId:await this.connection.sendRawTransaction(l[0].serialize(),{skipPreflight:s}),signedTx:l[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:t||{}}}buildMultiTx(t){var c;let{extraPreBuildData:n=[],extInfo:r}=t,{transaction:i}=this.build(r),o=n.filter(l=>l.transaction.instructions.length>0),s=[i,...o.map(l=>l.transaction)],a=[this.signers,...o.map(l=>l.signers)],u=[...this.instructionTypes,...o.map(l=>l.instructionTypes).flat()];return(c=this.owner)!=null&&c.signer&&a.forEach(l=>{l.some(f=>f.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),{builder:this,transactions:s,signers:a,instructionTypes:u,execute:async l=>{var P;let{sequentially:f,onTxUpdate:m,recentBlockHash:d,skipPreflight:T=!0}=l||{},g=d!=null?d:await de(this.connection,this.blockhashCommitment);if((P=this.owner)!=null&&P.isKeyPair){if(f){let w=[];for(let y of s){let h=await pt(this.connection,y,this.signers.find(b=>b.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:T});w.push(h)}return{txIds:w,signedTxs:s}}return{txIds:await await Promise.all(s.map(async w=>(w.recentBlockhash=g,await this.connection.sendRawTransaction(w.serialize(),{skipPreflight:T})))),signedTxs:s}}if(this.signAllTransactions){let w=s.map((h,b)=>(h.recentBlockhash=g,a[b].length&&h.sign(...a[b]),h));ce(w);let y=await this.signAllTransactions(w);if(f){let h=0,b=[],L=async()=>{if(!y[h])return;let S=await this.connection.sendRawTransaction(y[h].serialize(),{skipPreflight:T});b.push({txId:S,status:"sent",signedTx:y[h]}),m==null||m([...b]),h++,this.connection.onSignature(S,_=>{let k=b.findIndex(M=>M.txId===S);k>-1&&(b[k].status=_.err?"error":"success"),m==null||m([...b]),_.err||L()},"processed"),this.connection.getSignatureStatus(S)};return await L(),{txIds:b.map(S=>S.txId),signedTxs:y}}else{let h=[];for(let b=0;b<y.length;b+=1){let L=await this.connection.sendRawTransaction(y[b].serialize(),{skipPreflight:T});h.push(L)}return{txIds:h,signedTxs:y}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:r||{}}}async versionMultiBuild({extraPreBuildData:t,txVersion:n,extInfo:r}){return n===0?await this.buildV0MultiTx({extraPreBuildData:t,buildProps:r||{}}):this.buildMultiTx({extraPreBuildData:t,extInfo:r})}async buildV0(t){var g;let T=t||{},{lookupTableCache:n={},lookupTableAddress:r=[],forerunCreate:i,recentBlockhash:o}=T,s=De(T,["lookupTableCache","lookupTableAddress","forerunCreate","recentBlockhash"]),a=G(G({},this.cluster==="devnet"?{}:Ye),n),u=Array.from(new Set([...r,...this.lookupTableAddress])),c=[];for(let P of u)a[P]===void 0&&c.push(new Be(P));let l=await dt({connection:this.connection,address:c});for(let[P,w]of Object.entries(l))a[P]=w;let f=i?Be.default.toBase58():o!=null?o:await de(this.connection,this.blockhashCommitment),m=new Le({payerKey:this.feePayer,recentBlockhash:f,instructions:[...this.allInstructions]}).compileToV0Message(Object.values(a));((g=this.owner)==null?void 0:g.signer)&&!this.signers.some(P=>P.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer);let d=new Ce(m);return d.sign(this.signers),{builder:this,transaction:d,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async P=>{var h;let{skipPreflight:w=!0,sendAndConfirm:y}=P||{};if(ce([d]),(h=this.owner)!=null&&h.isKeyPair){let b=await this.connection.sendTransaction(d,{skipPreflight:w});if(y){let{lastValidBlockHeight:L,blockhash:S}=await this.connection.getLatestBlockhash({commitment:this.blockhashCommitment});await this.connection.confirmTransaction({blockhash:S,lastValidBlockHeight:L,signature:b},"confirmed")}return{txId:b,signedTx:d}}if(this.signAllTransactions){let b=await this.signAllTransactions([d]);return{txId:await this.connection.sendTransaction(b[0],{skipPreflight:w}),signedTx:b[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:s||{}}}async buildV0MultiTx(t){var c;let{extraPreBuildData:n=[],buildProps:r}=t,{transaction:i}=await this.buildV0(r),o=n.filter(l=>l.builder.instructions.length>0),s=[i,...o.map(l=>l.transaction)],a=[this.signers,...o.map(l=>l.signers)],u=[...this.instructionTypes,...o.map(l=>l.instructionTypes).flat()];return(c=this.owner)!=null&&c.signer&&a.forEach(l=>{l.some(f=>f.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),s.forEach(async(l,f)=>{l.sign(a[f])}),{builder:this,transactions:s,signers:a,instructionTypes:u,buildProps:r,execute:async l=>{var g;let{sequentially:f,onTxUpdate:m,recentBlockHash:d,skipPreflight:T=!0}=l||{};if(d&&s.forEach(P=>P.message.recentBlockhash=d),ce(s),(g=this.owner)!=null&&g.isKeyPair){if(f){let P=[];for(let w of s){let y=await this.connection.sendTransaction(w,{skipPreflight:T}),{lastValidBlockHeight:h,blockhash:b}=await this.connection.getLatestBlockhash({commitment:this.blockhashCommitment});await this.connection.confirmTransaction({blockhash:b,lastValidBlockHeight:h,signature:y},"confirmed"),P.push(y)}return{txIds:P,signedTxs:s}}return{txIds:await Promise.all(s.map(async P=>await this.connection.sendTransaction(P,{skipPreflight:T}))),signedTxs:s}}if(this.signAllTransactions){let P=await this.signAllTransactions(s);if(f){let w=0,y=[],h=async()=>{if(!P[w])return;let b=await this.connection.sendTransaction(P[w],{skipPreflight:T});y.push({txId:b,status:"sent",signedTx:P[w]}),m==null||m([...y]),w++,this.connection.onSignature(b,L=>{let S=y.findIndex(_=>_.txId===b);S>-1&&(y[S].status=L.err?"error":"success"),m==null||m([...y]),L.err||h()},"processed"),this.connection.getSignatureStatus(b)};return h(),{txIds:[],signedTxs:P}}else{let w=[];for(let y=0;y<P.length;y+=1){let h=await this.connection.sendTransaction(P[y],{skipPreflight:T});w.push(h)}return{txIds:w,signedTxs:P}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:r||{}}}async sizeCheckBuild(t){var l;let c=t||{},{computeBudgetConfig:n}=c,r=De(c,["computeBudgetConfig"]),i=n?Me(n):{instructions:[],instructionTypes:[]},o=this.signers.reduce((f,m)=>ne(G({},f),{[m.publicKey.toBase58()]:m}),{}),s=[],a=[],u=[];if(this.allInstructions.forEach(f=>{let m=[...u,f],d=n?[...i.instructions,...m]:m,g=[...new Set(m.map(P=>P.keys.filter(w=>w.isSigner).map(w=>w.pubkey.toString())).flat()).values()].map(P=>new Be(P));if(u.length<12&&we({instructions:d,payer:this.feePayer,signers:g})||we({instructions:m,payer:this.feePayer,signers:g}))u.push(f);else{if(u.length===0)throw Error("item ins too big");we({instructions:n?[...i.instructions,...u]:[...u],payer:this.feePayer,signers:g})?s.push(new ke().add(...i.instructions,...u)):s.push(new ke().add(...u)),a.push(Array.from(new Set(u.map(P=>P.keys.filter(w=>w.isSigner).map(w=>w.pubkey.toString())).flat())).map(P=>o[P]).filter(P=>P!==void 0)),u=[f]}}),u.length>0){let m=[...new Set(u.map(d=>d.keys.filter(T=>T.isSigner).map(T=>T.pubkey.toString())).flat()).values()].map(d=>o[d]).filter(d=>d!==void 0);we({instructions:n?[...i.instructions,...u]:[...u],payer:this.feePayer,signers:m.map(d=>d.publicKey)})?s.push(new ke().add(...i.instructions,...u)):s.push(new ke().add(...u)),a.push(m)}return s.forEach(f=>f.feePayer=this.feePayer),(l=this.owner)!=null&&l.signer&&a.forEach(f=>{f.some(m=>m.publicKey.equals(this.owner.publicKey))||f.push(this.owner.signer)}),{builder:this,transactions:s,signers:a,instructionTypes:this.instructionTypes,execute:async f=>{var w;let{sequentially:m,onTxUpdate:d,recentBlockHash:T,skipPreflight:g=!0}=f||{},P=T!=null?T:await de(this.connection,this.blockhashCommitment);if(s.forEach(async(y,h)=>{y.recentBlockhash=P,a[h].length&&y.sign(...a[h])}),ce(s),(w=this.owner)!=null&&w.isKeyPair){if(m){let y=[];for(let h of s){let b=await pt(this.connection,h,this.signers.find(L=>L.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:g});y.push(b)}return{txIds:y,signedTxs:s}}return{txIds:await Promise.all(s.map(async y=>await this.connection.sendRawTransaction(y.serialize(),{skipPreflight:g}))),signedTxs:s}}if(this.signAllTransactions){let y=await this.signAllTransactions(s);if(m){let h=0,b=[],L=async()=>{if(!y[h])return;let S=await this.connection.sendRawTransaction(y[h].serialize(),{skipPreflight:g});b.push({txId:S,status:"sent",signedTx:y[h]}),d==null||d([...b]),h++,this.connection.onSignature(S,_=>{let k=b.findIndex(M=>M.txId===S);k>-1&&(b[k].status=_.err?"error":"success"),d==null||d([...b]),_.err||L()},"processed"),this.connection.getSignatureStatus(S)};return await L(),{txIds:b.map(S=>S.txId),signedTxs:y}}else{let h=[];for(let b=0;b<y.length;b+=1){let L=await this.connection.sendRawTransaction(y[b].serialize(),{skipPreflight:g});h.push(L)}return{txIds:h,signedTxs:y}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:r||{}}}async sizeCheckBuildV0(t){var w;let P=t||{},{computeBudgetConfig:n,lookupTableCache:r={},lookupTableAddress:i=[]}=P,o=De(P,["computeBudgetConfig","lookupTableCache","lookupTableAddress"]),s=G(G({},this.cluster==="devnet"?{}:Ye),r),a=Array.from(new Set([...this.lookupTableAddress,...i])),u=[];for(let y of a)s[y]===void 0&&u.push(new Be(y));let c=await dt({connection:this.connection,address:u});for(let[y,h]of Object.entries(c))s[y]=h;let l=n?Me(n):{instructions:[],instructionTypes:[]},f=await de(this.connection,this.blockhashCommitment),m=this.signers.reduce((y,h)=>ne(G({},y),{[h.publicKey.toBase58()]:h}),{}),d=[],T=[],g=[];if(this.allInstructions.forEach(y=>{let h=[...g,y],b=n?[...l.instructions,...h]:h;if(g.length<12&&Te({instructions:b,payer:this.feePayer,lookupTableAddressAccount:s})||Te({instructions:h,payer:this.feePayer,lookupTableAddressAccount:s}))g.push(y);else{if(g.length===0)throw Error("item ins too big");let L={};for(let S of[...new Set(a)])s[S]!==void 0&&(L[S]=s[S]);if(n&&Te({instructions:[...l.instructions,...g],payer:this.feePayer,lookupTableAddressAccount:s,recentBlockhash:f})){let S=new Le({payerKey:this.feePayer,recentBlockhash:f,instructions:[...l.instructions,...g]}).compileToV0Message(Object.values(s));d.push(new Ce(S))}else{let S=new Le({payerKey:this.feePayer,recentBlockhash:f,instructions:[...g]}).compileToV0Message(Object.values(s));d.push(new Ce(S))}T.push(Array.from(new Set(g.map(S=>S.keys.filter(_=>_.isSigner).map(_=>_.pubkey.toString())).flat())).map(S=>m[S]).filter(S=>S!==void 0)),g=[y]}}),g.length>0){let h=[...new Set(g.map(b=>b.keys.filter(L=>L.isSigner).map(L=>L.pubkey.toString())).flat()).values()].map(b=>m[b]).filter(b=>b!==void 0);if(n&&Te({instructions:[...l.instructions,...g],payer:this.feePayer,lookupTableAddressAccount:s,recentBlockhash:f})){let b=new Le({payerKey:this.feePayer,recentBlockhash:f,instructions:[...l.instructions,...g]}).compileToV0Message(Object.values(s));d.push(new Ce(b))}else{let b=new Le({payerKey:this.feePayer,recentBlockhash:f,instructions:[...g]}).compileToV0Message(Object.values(s));d.push(new Ce(b))}T.push(h)}return(w=this.owner)!=null&&w.signer&&T.forEach(y=>{y.some(h=>h.publicKey.equals(this.owner.publicKey))||y.push(this.owner.signer)}),{builder:this,transactions:d,buildProps:t,signers:T,instructionTypes:this.instructionTypes,execute:async y=>{var _;let{sequentially:h,onTxUpdate:b,recentBlockHash:L,skipPreflight:S=!0}=y||{};if(d.map(async(k,M)=>{T[M].length&&k.sign(T[M]),L&&(k.message.recentBlockhash=L)}),ce(d),(_=this.owner)!=null&&_.isKeyPair){if(h){let k=[];for(let M of d){let W=await this.connection.sendTransaction(M,{skipPreflight:S}),{lastValidBlockHeight:v,blockhash:Z}=await this.connection.getLatestBlockhash({commitment:this.blockhashCommitment});await this.connection.confirmTransaction({blockhash:Z,lastValidBlockHeight:v,signature:W},"confirmed"),k.push(W)}return{txIds:k,signedTxs:d}}return{txIds:await Promise.all(d.map(async k=>await this.connection.sendTransaction(k,{skipPreflight:S}))),signedTxs:d}}if(this.signAllTransactions){let k=await this.signAllTransactions(d);if(h){let M=0,W=[],v=async()=>{if(!k[M])return;let Z=await this.connection.sendTransaction(k[M],{skipPreflight:S});W.push({txId:Z,status:"sent",signedTx:k[M]}),b==null||b([...W]),M++,this.connection.onSignature(Z,ue=>{let me=W.findIndex(K=>K.txId===Z);me>-1&&(W[me].status=ue.err?"error":"success"),b==null||b([...W]),ue.err||v()},"processed"),this.connection.getSignatureStatus(Z)};return v(),{txIds:[],signedTxs:k}}else{let M=[];for(let W=0;W<k.length;W+=1){let v=await this.connection.sendTransaction(k[W],{skipPreflight:S});M.push(v)}return{txIds:M,signedTxs:k}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:o||{}}}};var gt=(...e)=>e.map(t=>{try{return typeof t=="object"?JSON.stringify(t):t}catch{return t}}).join(", "),Ne=class{constructor({scope:t,moduleName:n}){this.disabled=!1;this.scope=t,this.logger=H(n)}createTxBuilder(t){return this.scope.checkOwner(),new Ze({connection:this.scope.connection,feePayer:t||this.scope.ownerPubKey,cluster:this.scope.cluster,owner:this.scope.owner,blockhashCommitment:this.scope.blockhashCommitment,api:this.scope.api,signAllTransactions:this.scope.signAllTransactions})}logDebug(...t){this.logger.debug(gt(t))}logInfo(...t){this.logger.info(gt(t))}logAndCreateError(...t){let n=gt(t);throw new Error(n)}checkDisabled(){(this.disabled||!this.scope)&&this.logAndCreateError("module not working")}};import{PublicKey as Or}from"@solana/web3.js";import sn,{isBN as an}from"bn.js";import{bits as Fa,BitStructure as va,blob as Ir,Blob as Ka,cstr as Va,f32 as Wa,f32be as Ua,f64 as qa,f64be as Ga,greedy as Ha,Layout as Er,ns64 as ja,ns64be as za,nu64 as Ya,nu64be as Za,offset as Ja,s16 as Xa,s16be as Qa,s24 as $a,s24be as eu,s32 as tu,s32be as nu,s40 as ru,s40be as iu,s48 as ou,s48be as su,s8 as au,seq as Dr,struct as uu,Structure as Mr,u16 as cu,u16be as lu,u24 as fu,u24be as mu,u32 as du,u32be as pu,u40 as gu,u40be as hu,u48 as bu,u48be as yu,u8 as wu,UInt as Rr,union as Tu,Union as Pu,unionLayoutDiscriminator as xu,utf8 as Au}from"@solana/buffer-layout";var ht=Er,nn=Mr;var rn=Rr;var on=Dr;var he=Ir;var bt=class extends ht{constructor(n,r,i){super(n,i);this.blob=he(n),this.signed=r}decode(n,r=0){let i=new sn(this.blob.decode(n,r),10,"le");return this.signed?i.fromTwos(this.span*8).clone():i}encode(n,r,i=0){return typeof n=="number"&&(n=new sn(n)),this.signed&&(n=n.toTwos(this.span*8)),this.blob.encode(n.toArrayLike(Buffer,"le",this.span),r,i)}};function be(e){return new rn(1,e)}function $(e){return new bt(8,!1,e)}var yt=class extends ht{constructor(n,r,i,o){super(n.span,o);this.layout=n,this.decoder=r,this.encoder=i}decode(n,r){return this.decoder(this.layout.decode(n,r))}encode(n,r,i){return this.layout.encode(this.encoder(n),r,i)}getSpan(n,r){return this.layout.getSpan(n,r)}};function fe(e){return new yt(he(32),t=>new Or(t),t=>t.toBuffer(),e)}var wt=class extends nn{decode(t,n){return super.decode(t,n)}};function ye(e,t,n){return new wt(e,t,n)}function Ie(e,t,n){let r,i=typeof t=="number"?t:an(t)?t.toNumber():new Proxy(t,{get(o,s){if(!r){let a=Reflect.get(o,"count");r=an(a)?a.toNumber():a,Reflect.set(o,"count",r)}return Reflect.get(o,s)},set(o,s,a){return s==="count"&&(r=a),Reflect.set(o,s,a)}});return on(e,i,n)}var q=class extends Ne{static getPdaPoolId(t,n){return Re([q.SEED_CONFIG.pool.id,n.toBuffer()],t)}static getPdaOwnerId(t,n,r,i){return Re([q.SEED_CONFIG.owner.id,n.toBuffer(),r.toBuffer(),Buffer.from(new un(i).toArray())],t)}static async getAllInfo({connection:t,programId:n,poolIds:r,wallet:i,chainTime:o}){if(r.length===0)return[];let s=r.map(l=>q.getPdaPoolId(n,l).publicKey),a=[];for(let l=0;l<q.VERSION_PROJECT.length;l++)a.push(...s.map(f=>q.getPdaOwnerId(n,f,i,l).publicKey));let u=await je(t,[...s,...a]),c=[];for(let l=0;l<u.length;l++){let f=Math.floor(l/r.length),m=l%r.length,d=s[m],T=a[l],g=u[m],P=u[r.length+l];if(!(g&&P)||g.data.length!==q.POOL_LAYOUT.span||P.data.length!==q.OWNER_LAYOUT.span)continue;let w=q.POOL_LAYOUT.decode(g.data),y=q.OWNER_LAYOUT.decode(P.data),h=w.openTime.toNumber(),b=w.endTime.toNumber(),L=y.tokenInfo.map(k=>k.debtAmount.gt(new un(0))).filter(k=>!k).length!==3,S=o>h&&o<b&&w.status===1,_=L&&S;c.push({programId:n,poolId:d,ammId:w.ammId,ownerAccountId:T,snapshotLpAmount:y.lpAmount,project:q.VERSION_PROJECT[f],openTime:h,endTime:b,canClaim:_,canClaimErrorType:L?S?void 0:"outOfOperationalTime":"alreadyClaimIt",tokenInfo:w.tokenInfo.map((k,M)=>({mintAddress:k.mintAddress,mintVault:k.mintVault,mintDecimals:k.mintDecimals,perLpLoss:k.perLpLoss,debtAmount:y.tokenInfo[M].debtAmount.add(y.tokenInfo[M].claimedAmount)}))})}return c}async makeClaimTransaction({poolInfo:t,ownerInfo:n}){n.wallet||this.scope.checkOwner();let r=this.createTxBuilder(),i=n.wallet||this.scope.ownerPubKey,o=[];for(let u of t.tokenInfo){let{account:c,instructionParams:l}=await this.scope.account.getOrCreateTokenAccount({mint:u.mintAddress,owner:this.scope.ownerPubKey,notUseTokenAccount:u.mintAddress.equals(Y.WSOL.mint),createInfo:{payer:i,amount:0},skipCloseAccount:!u.mintAddress.equals(Y.WSOL.mint),associatedOnly:u.mintAddress.equals(Y.WSOL.mint)?!1:n.associatedOnly});l&&r.addInstruction(l),o.push(c)}r.addInstruction({instructions:[q.makeClaimInstruction({programId:t.programId,poolInfo:t,ownerInfo:{wallet:i,ownerPda:t.ownerAccountId,claimAddress:o}})]});let{transaction:s,signers:a}=r.build();return[{transaction:s,signer:a}]}async makeClaimAllTransaction({poolInfos:t,ownerInfo:n}){let r=this.createTxBuilder(),i=n.wallet||this.scope.ownerPubKey,o={};for(let c of t){let l=[];for(let f of c.tokenInfo){let{account:m,instructionParams:d}=await this.scope.account.getOrCreateTokenAccount({mint:f.mintAddress,owner:this.scope.ownerPubKey,notUseTokenAccount:f.mintAddress.equals(Y.WSOL.mint),createInfo:{payer:i,amount:0},skipCloseAccount:!f.mintAddress.equals(Y.WSOL.mint),associatedOnly:f.mintAddress.equals(Y.WSOL.mint)?!1:n.associatedOnly});d&&r.addInstruction(d),m&&(o[f.mintAddress.toString()]=m,l.push(m))}r.addInstruction({instructions:[q.makeClaimInstruction({programId:c.programId,poolInfo:c,ownerInfo:{wallet:i,ownerPda:c.ownerAccountId,claimAddress:l}})]})}let{transaction:s,signers:a}=r.build(),u=r.allInstructions;return Qe(u,[i,...a.map(c=>c.publicKey)])?[{transaction:s,signer:a}]:[{transaction:new Tt().add(...u.slice(0,r.AllTxData.instructions.length-1)),signer:a},{transaction:new Tt().add(...u.slice(r.AllTxData.instructions.length-1)),signer:[]},{transaction:new Tt().add(...r.AllTxData.endInstructions),signer:[]}]}static makeClaimInstruction({programId:t,poolInfo:n,ownerInfo:r}){let i=ye([]),o=[{pubkey:r.wallet,isSigner:!0,isWritable:!0},{pubkey:n.poolId,isSigner:!1,isWritable:!0},{pubkey:r.ownerPda,isSigner:!1,isWritable:!0},...r.claimAddress.map(u=>({pubkey:u,isSigner:!1,isWritable:!0})),...n.tokenInfo.map(({mintVault:u})=>({pubkey:u,isSigner:!1,isWritable:!0})),{pubkey:_r,isSigner:!1,isWritable:!1}],s=Buffer.alloc(i.span);i.encode({},s);let a=Buffer.from([10,66,208,184,161,6,191,98,...s]);return new vr({keys:o,programId:t,data:a})}},ee=q;ee.CLAIMED_NUM=3,ee.POOL_LAYOUT=ye([he(8),be("bump"),be("status"),$("openTime"),$("endTime"),fe("ammId"),Ie(ye([be("mintDecimals"),fe("mintAddress"),fe("mintVault"),$("perLpLoss"),$("totalClaimedAmount")]),q.CLAIMED_NUM,"tokenInfo"),Ie($(),10,"padding")]),ee.OWNER_LAYOUT=ye([he(8),be("bump"),be("version"),fe("poolId"),fe("owner"),$("lpAmount"),Ie(ye([fe("mintAddress"),$("debtAmount"),$("claimedAmount")]),q.CLAIMED_NUM,"tokenInfo"),Ie($(),4,"padding")]),ee.DEFAULT_POOL_ID=["58oQChx4yWmvKdwLLZzBi4ChoCc2fqCUWBkwMihLYQo2","6UmmUiYoBjSrhakAobJw8BvkmJtDVxaeBtbt7rxWo1mg","AVs9TA4nWDzfPJE9gGVNJMVhcQy3V9PGazuz33BfG2RA","DVa7Qmb5ct9RCpaU7UTpSaf3GVMYz17vNVU67XpdCRut","7XawhbbxtsRcQA8KTkHT9f9nc6d69UwqCDh6U5EEbEmX","6a1CsrpeZubDjEJE9s1CMVheB6HWM5d7m1cj2jkhyXhj","EoNrn8iUhwgJySD1pHu8Qxm5gSQqLK3za4m8xzD2RuEb","AceAyRTWt4PyB2pHqf2qhDgNZDtKVNaxgL8Ru3V4aN1P","6tmFJbMk5yVHFcFy7X2K8RwHjKLr6KVFLYXpgpBNeAxB"].map(t=>new Fr(t)),ee.SEED_CONFIG={pool:{id:Buffer.from("pool_seed","utf8")},owner:{id:Buffer.from("user_claim_seed","utf8")}},ee.VERSION_PROJECT=[void 0,"Francium","Tulip","Larix"];export{ee as default};
//# sourceMappingURL=index.mjs.map