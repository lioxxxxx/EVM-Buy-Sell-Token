var $t=Object.defineProperty,en=Object.defineProperties;var tn=Object.getOwnPropertyDescriptors;var at=Object.getOwnPropertySymbols;var nn=Object.prototype.hasOwnProperty,rn=Object.prototype.propertyIsEnumerable;var ut=(e,t,n)=>t in e?$t(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ee=(e,t)=>{for(var n in t||(t={}))nn.call(t,n)&&ut(e,n,t[n]);if(at)for(var n of at(t))rn.call(t,n)&&ut(e,n,t[n]);return e},ie=(e,t)=>en(e,tn(t));import{PublicKey as mn}from"@solana/web3.js";import dt,{isBN as gt}from"bn.js";import{bits as jr,BitStructure as Zr,blob as on,Blob as Yr,cstr as Jr,f32 as Xr,f32be as Qr,f64 as $r,f64be as ei,greedy as ti,Layout as sn,ns64 as ni,ns64be as ri,nu64 as ii,nu64be as oi,offset as si,s16 as ai,s16be as ui,s24 as ci,s24be as li,s32 as fi,s32be as mi,s40 as pi,s40be as di,s48 as gi,s48be as hi,s8 as bi,seq as an,struct as yi,Structure as un,u16 as cn,u16be as wi,u24 as Pi,u24be as Ti,u32 as xi,u32be as Ai,u40 as Bi,u40be as Si,u48 as ki,u48be as Ni,u8 as ln,UInt as fn,union as Ci,Union as Li,unionLayoutDiscriminator as Ii,utf8 as Ei}from"@solana/buffer-layout";var We=sn,ct=un;var lt=fn;var ft=ln,mt=cn;var pt=an;var oe=on;var Ve=class extends We{constructor(n,r,i){super(n,i);this.blob=oe(n),this.signed=r}decode(n,r=0){let i=new dt(this.blob.decode(n,r),10,"le");return this.signed?i.fromTwos(this.span*8).clone():i}encode(n,r,i=0){return typeof n=="number"&&(n=new dt(n)),this.signed&&(n=n.toTwos(this.span*8)),this.blob.encode(n.toArrayLike(Buffer,"le",this.span),r,i)}};function te(e){return new lt(1,e)}function k(e){return new Ve(8,!1,e)}var Te=class extends We{constructor(n,r,i,o){super(n.span,o);this.layout=n,this.decoder=r,this.encoder=i}decode(n,r){return this.decoder(this.layout.decode(n,r))}encode(n,r,i){return this.layout.encode(this.encoder(n),r,i)}getSpan(n,r){return this.layout.getSpan(n,r)}};function W(e){return new Te(oe(32),t=>new mn(t),t=>t.toBuffer(),e)}function ht(e){return new Te(ft(),pn,dn,e)}function pn(e){if(e===0)return!1;if(e===1)return!0;throw new Error("Invalid bool: "+e)}function dn(e){return e?1:0}var qe=class extends ct{decode(t,n){return super.decode(t,n)}};function z(e,t,n){return new qe(e,t,n)}function Ue(e,t,n){let r,i=typeof t=="number"?t:gt(t)?t.toNumber():new Proxy(t,{get(o,s){if(!r){let a=Reflect.get(o,"count");r=gt(a)?a.toNumber():a,Reflect.set(o,"count",r)}return Reflect.get(o,s)},set(o,s,a){return s==="count"&&(r=a),Reflect.set(o,s,a)}});return pt(e,i,n)}var Hi=z([oe(8),te("bump"),ht("disableCreatePool"),mt("index"),k("tradeFeeRate"),k("protocolFeeRate"),k("fundFeeRate"),k("createPoolFee"),W("protocolOwner"),W("fundOwner"),Ue(k(),16)]),zi=z([oe(8),W("configId"),W("poolCreator"),W("vaultA"),W("vaultB"),W("mintLp"),W("mintA"),W("mintB"),W("mintProgramA"),W("mintProgramB"),W("observationId"),te("bump"),te("status"),te("lpDecimals"),te("mintDecimalA"),te("mintDecimalB"),k("lpAmount"),k("protocolFeesMintA"),k("protocolFeesMintB"),k("fundFeesMintA"),k("fundFeesMintB"),k("openTime"),Ue(k(),32)]);import{TransactionInstruction as ge}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as it,TOKEN_2022_PROGRAM_ID as jt,ASSOCIATED_TOKEN_PROGRAM_ID as Ir}from"@solana/spl-token";import{get as bt,set as gn}from"lodash";var Ge=class{constructor(t){this.logLevel=t.logLevel!==void 0?t.logLevel:0,this.name=t.name}set level(t){this.logLevel=t}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(t){return t<=this.logLevel}error(...t){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...t),this):this}logWithError(...t){let n=t.map(r=>typeof r=="object"?JSON.stringify(r):r).join(", ");throw new Error(n)}warning(...t){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...t),this):this}info(...t){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...t),this):this}debug(...t){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...t),this):this}},yt={},hn={};function v(e){let t=bt(yt,e);if(!t){let n=bt(hn,e);t=new Ge({name:e,logLevel:n}),gn(yt,e,t)}return t}import{PublicKey as Zs}from"@solana/web3.js";import Js from"bn.js";import Ar from"big.js";import Cs from"bn.js";import O from"bn.js";var se=9e15,X=1e9,He="0123456789abcdef",Ae="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",Be="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",ze={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-se,maxE:se,crypto:!1},xt,j,w=!0,ke="[DecimalError] ",J=ke+"Invalid argument: ",At=ke+"Precision limit exceeded",Bt=ke+"crypto unavailable",St="[object Decimal]",_=Math.floor,M=Math.pow,bn=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,yn=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,wn=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,kt=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,G=1e7,b=7,Pn=9007199254740991,Tn=Ae.length-1,je=Be.length-1,p={toStringTag:St};p.absoluteValue=p.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),h(e)};p.ceil=function(){return h(new this.constructor(this),this.e+1,2)};p.clampedTo=p.clamp=function(e,t){var n,r=this,i=r.constructor;if(e=new i(e),t=new i(t),!e.s||!t.s)return new i(NaN);if(e.gt(t))throw Error(J+t);return n=r.cmp(e),n<0?e:r.cmp(t)>0?t:new i(r)};p.comparedTo=p.cmp=function(e){var t,n,r,i,o=this,s=o.d,a=(e=new o.constructor(e)).d,c=o.s,u=e.s;if(!s||!a)return!c||!u?NaN:c!==u?c:s===a?0:!s^c<0?1:-1;if(!s[0]||!a[0])return s[0]?c:a[0]?-u:0;if(c!==u)return c;if(o.e!==e.e)return o.e>e.e^c<0?1:-1;for(r=s.length,i=a.length,t=0,n=r<i?r:i;t<n;++t)if(s[t]!==a[t])return s[t]>a[t]^c<0?1:-1;return r===i?0:r>i^c<0?1:-1};p.cosine=p.cos=function(){var e,t,n=this,r=n.constructor;return n.d?n.d[0]?(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+b,r.rounding=1,n=xn(r,Et(r,n)),r.precision=e,r.rounding=t,h(j==2||j==3?n.neg():n,e,t,!0)):new r(1):new r(NaN)};p.cubeRoot=p.cbrt=function(){var e,t,n,r,i,o,s,a,c,u,l=this,f=l.constructor;if(!l.isFinite()||l.isZero())return new f(l);for(w=!1,o=l.s*M(l.s*l,1/3),!o||Math.abs(o)==1/0?(n=R(l.d),e=l.e,(o=(e-n.length+1)%3)&&(n+=o==1||o==-2?"0":"00"),o=M(n,1/3),e=_((e+1)/3)-(e%3==(e<0?-1:2)),o==1/0?n="5e"+e:(n=o.toExponential(),n=n.slice(0,n.indexOf("e")+1)+e),r=new f(n),r.s=l.s):r=new f(o.toString()),s=(e=f.precision)+3;;)if(a=r,c=a.times(a).times(a),u=c.plus(l),r=N(u.plus(l).times(a),u.plus(c),s+2,1),R(a.d).slice(0,s)===(n=R(r.d)).slice(0,s))if(n=n.slice(s-3,s+1),n=="9999"||!i&&n=="4999"){if(!i&&(h(a,e+1,0),a.times(a).times(a).eq(l))){r=a;break}s+=4,i=1}else{(!+n||!+n.slice(1)&&n.charAt(0)=="5")&&(h(r,e+1,1),t=!r.times(r).times(r).eq(l));break}return w=!0,h(r,e,f.rounding,t)};p.decimalPlaces=p.dp=function(){var e,t=this.d,n=NaN;if(t){if(e=t.length-1,n=(e-_(this.e/b))*b,e=t[e],e)for(;e%10==0;e/=10)n--;n<0&&(n=0)}return n};p.dividedBy=p.div=function(e){return N(this,new this.constructor(e))};p.dividedToIntegerBy=p.divToInt=function(e){var t=this,n=t.constructor;return h(N(t,new n(e),0,1,1),n.precision,n.rounding)};p.equals=p.eq=function(e){return this.cmp(e)===0};p.floor=function(){return h(new this.constructor(this),this.e+1,3)};p.greaterThan=p.gt=function(e){return this.cmp(e)>0};p.greaterThanOrEqualTo=p.gte=function(e){var t=this.cmp(e);return t==1||t===0};p.hyperbolicCosine=p.cosh=function(){var e,t,n,r,i,o=this,s=o.constructor,a=new s(1);if(!o.isFinite())return new s(o.s?1/0:NaN);if(o.isZero())return a;n=s.precision,r=s.rounding,s.precision=n+Math.max(o.e,o.sd())+4,s.rounding=1,i=o.d.length,i<32?(e=Math.ceil(i/3),t=(1/Ce(4,e)).toString()):(e=16,t="2.3283064365386962890625e-10"),o=ae(s,1,o.times(t),new s(1),!0);for(var c,u=e,l=new s(8);u--;)c=o.times(o),o=a.minus(c.times(l.minus(c.times(l))));return h(o,s.precision=n,s.rounding=r,!0)};p.hyperbolicSine=p.sinh=function(){var e,t,n,r,i=this,o=i.constructor;if(!i.isFinite()||i.isZero())return new o(i);if(t=o.precision,n=o.rounding,o.precision=t+Math.max(i.e,i.sd())+4,o.rounding=1,r=i.d.length,r<3)i=ae(o,2,i,i,!0);else{e=1.4*Math.sqrt(r),e=e>16?16:e|0,i=i.times(1/Ce(5,e)),i=ae(o,2,i,i,!0);for(var s,a=new o(5),c=new o(16),u=new o(20);e--;)s=i.times(i),i=i.times(a.plus(s.times(c.times(s).plus(u))))}return o.precision=t,o.rounding=n,h(i,t,n,!0)};p.hyperbolicTangent=p.tanh=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+7,r.rounding=1,N(n.sinh(),n.cosh(),r.precision=e,r.rounding=t)):new r(n.s)};p.inverseCosine=p.acos=function(){var e,t=this,n=t.constructor,r=t.abs().cmp(1),i=n.precision,o=n.rounding;return r!==-1?r===0?t.isNeg()?U(n,i,o):new n(0):new n(NaN):t.isZero()?U(n,i+4,o).times(.5):(n.precision=i+6,n.rounding=1,t=t.asin(),e=U(n,i+4,o).times(.5),n.precision=i,n.rounding=o,e.minus(t))};p.inverseHyperbolicCosine=p.acosh=function(){var e,t,n=this,r=n.constructor;return n.lte(1)?new r(n.eq(1)?0:NaN):n.isFinite()?(e=r.precision,t=r.rounding,r.precision=e+Math.max(Math.abs(n.e),n.sd())+4,r.rounding=1,w=!1,n=n.times(n).minus(1).sqrt().plus(n),w=!0,r.precision=e,r.rounding=t,n.ln()):new r(n)};p.inverseHyperbolicSine=p.asinh=function(){var e,t,n=this,r=n.constructor;return!n.isFinite()||n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+2*Math.max(Math.abs(n.e),n.sd())+6,r.rounding=1,w=!1,n=n.times(n).plus(1).sqrt().plus(n),w=!0,r.precision=e,r.rounding=t,n.ln())};p.inverseHyperbolicTangent=p.atanh=function(){var e,t,n,r,i=this,o=i.constructor;return i.isFinite()?i.e>=0?new o(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(e=o.precision,t=o.rounding,r=i.sd(),Math.max(r,e)<2*-i.e-1?h(new o(i),e,t,!0):(o.precision=n=r-i.e,i=N(i.plus(1),new o(1).minus(i),n+e,1),o.precision=e+4,o.rounding=1,i=i.ln(),o.precision=e,o.rounding=t,i.times(.5))):new o(NaN)};p.inverseSine=p.asin=function(){var e,t,n,r,i=this,o=i.constructor;return i.isZero()?new o(i):(t=i.abs().cmp(1),n=o.precision,r=o.rounding,t!==-1?t===0?(e=U(o,n+4,r).times(.5),e.s=i.s,e):new o(NaN):(o.precision=n+6,o.rounding=1,i=i.div(new o(1).minus(i.times(i)).sqrt().plus(1)).atan(),o.precision=n,o.rounding=r,i.times(2)))};p.inverseTangent=p.atan=function(){var e,t,n,r,i,o,s,a,c,u=this,l=u.constructor,f=l.precision,m=l.rounding;if(u.isFinite()){if(u.isZero())return new l(u);if(u.abs().eq(1)&&f+4<=je)return s=U(l,f+4,m).times(.25),s.s=u.s,s}else{if(!u.s)return new l(NaN);if(f+4<=je)return s=U(l,f+4,m).times(.5),s.s=u.s,s}for(l.precision=a=f+10,l.rounding=1,n=Math.min(28,a/b+2|0),e=n;e;--e)u=u.div(u.times(u).plus(1).sqrt().plus(1));for(w=!1,t=Math.ceil(a/b),r=1,c=u.times(u),s=new l(u),i=u;e!==-1;)if(i=i.times(c),o=s.minus(i.div(r+=2)),i=i.times(c),s=o.plus(i.div(r+=2)),s.d[t]!==void 0)for(e=t;s.d[e]===o.d[e]&&e--;);return n&&(s=s.times(2<<n-1)),w=!0,h(s,l.precision=f,l.rounding=m,!0)};p.isFinite=function(){return!!this.d};p.isInteger=p.isInt=function(){return!!this.d&&_(this.e/b)>this.d.length-2};p.isNaN=function(){return!this.s};p.isNegative=p.isNeg=function(){return this.s<0};p.isPositive=p.isPos=function(){return this.s>0};p.isZero=function(){return!!this.d&&this.d[0]===0};p.lessThan=p.lt=function(e){return this.cmp(e)<0};p.lessThanOrEqualTo=p.lte=function(e){return this.cmp(e)<1};p.logarithm=p.log=function(e){var t,n,r,i,o,s,a,c,u=this,l=u.constructor,f=l.precision,m=l.rounding,d=5;if(e==null)e=new l(10),t=!0;else{if(e=new l(e),n=e.d,e.s<0||!n||!n[0]||e.eq(1))return new l(NaN);t=e.eq(10)}if(n=u.d,u.s<0||!n||!n[0]||u.eq(1))return new l(n&&!n[0]?-1/0:u.s!=1?NaN:n?0:1/0);if(t)if(n.length>1)o=!0;else{for(i=n[0];i%10===0;)i/=10;o=i!==1}if(w=!1,a=f+d,s=Y(u,a),r=t?Se(l,a+10):Y(e,a),c=N(s,r,a,1),fe(c.d,i=f,m))do if(a+=10,s=Y(u,a),r=t?Se(l,a+10):Y(e,a),c=N(s,r,a,1),!o){+R(c.d).slice(i+1,i+15)+1==1e14&&(c=h(c,f+1,0));break}while(fe(c.d,i+=10,m));return w=!0,h(c,f,m)};p.minus=p.sub=function(e){var t,n,r,i,o,s,a,c,u,l,f,m,d=this,y=d.constructor;if(e=new y(e),!d.d||!e.d)return!d.s||!e.s?e=new y(NaN):d.d?e.s=-e.s:e=new y(e.d||d.s!==e.s?d:NaN),e;if(d.s!=e.s)return e.s=-e.s,d.plus(e);if(u=d.d,m=e.d,a=y.precision,c=y.rounding,!u[0]||!m[0]){if(m[0])e.s=-e.s;else if(u[0])e=new y(d);else return new y(c===3?-0:0);return w?h(e,a,c):e}if(n=_(e.e/b),l=_(d.e/b),u=u.slice(),o=l-n,o){for(f=o<0,f?(t=u,o=-o,s=m.length):(t=m,n=l,s=u.length),r=Math.max(Math.ceil(a/b),s)+2,o>r&&(o=r,t.length=1),t.reverse(),r=o;r--;)t.push(0);t.reverse()}else{for(r=u.length,s=m.length,f=r<s,f&&(s=r),r=0;r<s;r++)if(u[r]!=m[r]){f=u[r]<m[r];break}o=0}for(f&&(t=u,u=m,m=t,e.s=-e.s),s=u.length,r=m.length-s;r>0;--r)u[s++]=0;for(r=m.length;r>o;){if(u[--r]<m[r]){for(i=r;i&&u[--i]===0;)u[i]=G-1;--u[i],u[r]+=G}u[r]-=m[r]}for(;u[--s]===0;)u.pop();for(;u[0]===0;u.shift())--n;return u[0]?(e.d=u,e.e=Ne(u,n),w?h(e,a,c):e):new y(c===3?-0:0)};p.modulo=p.mod=function(e){var t,n=this,r=n.constructor;return e=new r(e),!n.d||!e.s||e.d&&!e.d[0]?new r(NaN):!e.d||n.d&&!n.d[0]?h(new r(n),r.precision,r.rounding):(w=!1,r.modulo==9?(t=N(n,e.abs(),0,3,1),t.s*=e.s):t=N(n,e,0,r.modulo,1),t=t.times(e),w=!0,n.minus(t))};p.naturalExponential=p.exp=function(){return Ze(this)};p.naturalLogarithm=p.ln=function(){return Y(this)};p.negated=p.neg=function(){var e=new this.constructor(this);return e.s=-e.s,h(e)};p.plus=p.add=function(e){var t,n,r,i,o,s,a,c,u,l,f=this,m=f.constructor;if(e=new m(e),!f.d||!e.d)return!f.s||!e.s?e=new m(NaN):f.d||(e=new m(e.d||f.s===e.s?f:NaN)),e;if(f.s!=e.s)return e.s=-e.s,f.minus(e);if(u=f.d,l=e.d,a=m.precision,c=m.rounding,!u[0]||!l[0])return l[0]||(e=new m(f)),w?h(e,a,c):e;if(o=_(f.e/b),r=_(e.e/b),u=u.slice(),i=o-r,i){for(i<0?(n=u,i=-i,s=l.length):(n=l,r=o,s=u.length),o=Math.ceil(a/b),s=o>s?o+1:s+1,i>s&&(i=s,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(s=u.length,i=l.length,s-i<0&&(i=s,n=l,l=u,u=n),t=0;i;)t=(u[--i]=u[i]+l[i]+t)/G|0,u[i]%=G;for(t&&(u.unshift(t),++r),s=u.length;u[--s]==0;)u.pop();return e.d=u,e.e=Ne(u,r),w?h(e,a,c):e};p.precision=p.sd=function(e){var t,n=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(J+e);return n.d?(t=Nt(n.d),e&&n.e+1>t&&(t=n.e+1)):t=NaN,t};p.round=function(){var e=this,t=e.constructor;return h(new t(e),e.e+1,t.rounding)};p.sine=p.sin=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+b,r.rounding=1,n=Bn(r,Et(r,n)),r.precision=e,r.rounding=t,h(j>2?n.neg():n,e,t,!0)):new r(NaN)};p.squareRoot=p.sqrt=function(){var e,t,n,r,i,o,s=this,a=s.d,c=s.e,u=s.s,l=s.constructor;if(u!==1||!a||!a[0])return new l(!u||u<0&&(!a||a[0])?NaN:a?s:1/0);for(w=!1,u=Math.sqrt(+s),u==0||u==1/0?(t=R(a),(t.length+c)%2==0&&(t+="0"),u=Math.sqrt(t),c=_((c+1)/2)-(c<0||c%2),u==1/0?t="5e"+c:(t=u.toExponential(),t=t.slice(0,t.indexOf("e")+1)+c),r=new l(t)):r=new l(u.toString()),n=(c=l.precision)+3;;)if(o=r,r=o.plus(N(s,o,n+2,1)).times(.5),R(o.d).slice(0,n)===(t=R(r.d)).slice(0,n))if(t=t.slice(n-3,n+1),t=="9999"||!i&&t=="4999"){if(!i&&(h(o,c+1,0),o.times(o).eq(s))){r=o;break}n+=4,i=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(h(r,c+1,1),e=!r.times(r).eq(s));break}return w=!0,h(r,c,l.rounding,e)};p.tangent=p.tan=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+10,r.rounding=1,n=n.sin(),n.s=1,n=N(n,new r(1).minus(n.times(n)).sqrt(),e+10,0),r.precision=e,r.rounding=t,h(j==2||j==4?n.neg():n,e,t,!0)):new r(NaN)};p.times=p.mul=function(e){var t,n,r,i,o,s,a,c,u,l=this,f=l.constructor,m=l.d,d=(e=new f(e)).d;if(e.s*=l.s,!m||!m[0]||!d||!d[0])return new f(!e.s||m&&!m[0]&&!d||d&&!d[0]&&!m?NaN:!m||!d?e.s/0:e.s*0);for(n=_(l.e/b)+_(e.e/b),c=m.length,u=d.length,c<u&&(o=m,m=d,d=o,s=c,c=u,u=s),o=[],s=c+u,r=s;r--;)o.push(0);for(r=u;--r>=0;){for(t=0,i=c+r;i>r;)a=o[i]+d[r]*m[i-r-1]+t,o[i--]=a%G|0,t=a/G|0;o[i]=(o[i]+t)%G|0}for(;!o[--s];)o.pop();return t?++n:o.shift(),e.d=o,e.e=Ne(o,n),w?h(e,f.precision,f.rounding):e};p.toBinary=function(e,t){return Je(this,2,e,t)};p.toDecimalPlaces=p.toDP=function(e,t){var n=this,r=n.constructor;return n=new r(n),e===void 0?n:(F(e,0,X),t===void 0?t=r.rounding:F(t,0,8),h(n,e+n.e+1,t))};p.toExponential=function(e,t){var n,r=this,i=r.constructor;return e===void 0?n=H(r,!0):(F(e,0,X),t===void 0?t=i.rounding:F(t,0,8),r=h(new i(r),e+1,t),n=H(r,!0,e+1)),r.isNeg()&&!r.isZero()?"-"+n:n};p.toFixed=function(e,t){var n,r,i=this,o=i.constructor;return e===void 0?n=H(i):(F(e,0,X),t===void 0?t=o.rounding:F(t,0,8),r=h(new o(i),e+i.e+1,t),n=H(r,!1,e+r.e+1)),i.isNeg()&&!i.isZero()?"-"+n:n};p.toFraction=function(e){var t,n,r,i,o,s,a,c,u,l,f,m,d=this,y=d.d,g=d.constructor;if(!y)return new g(d);if(u=n=new g(1),r=c=new g(0),t=new g(r),o=t.e=Nt(y)-d.e-1,s=o%b,t.d[0]=M(10,s<0?b+s:s),e==null)e=o>0?t:u;else{if(a=new g(e),!a.isInt()||a.lt(u))throw Error(J+a);e=a.gt(t)?o>0?t:u:a}for(w=!1,a=new g(R(y)),l=g.precision,g.precision=o=y.length*b*2;f=N(a,t,0,1,1),i=n.plus(f.times(r)),i.cmp(e)!=1;)n=r,r=i,i=u,u=c.plus(f.times(i)),c=i,i=t,t=a.minus(f.times(i)),a=i;return i=N(e.minus(n),r,0,1,1),c=c.plus(i.times(u)),n=n.plus(i.times(r)),c.s=u.s=d.s,m=N(u,r,o,1).minus(d).abs().cmp(N(c,n,o,1).minus(d).abs())<1?[u,r]:[c,n],g.precision=l,w=!0,m};p.toHexadecimal=p.toHex=function(e,t){return Je(this,16,e,t)};p.toNearest=function(e,t){var n=this,r=n.constructor;if(n=new r(n),e==null){if(!n.d)return n;e=new r(1),t=r.rounding}else{if(e=new r(e),t===void 0?t=r.rounding:F(t,0,8),!n.d)return e.s?n:e;if(!e.d)return e.s&&(e.s=n.s),e}return e.d[0]?(w=!1,n=N(n,e,0,t,1).times(e),w=!0,h(n)):(e.s=n.s,n=e),n};p.toNumber=function(){return+this};p.toOctal=function(e,t){return Je(this,8,e,t)};p.toPower=p.pow=function(e){var t,n,r,i,o,s,a=this,c=a.constructor,u=+(e=new c(e));if(!a.d||!e.d||!a.d[0]||!e.d[0])return new c(M(+a,u));if(a=new c(a),a.eq(1))return a;if(r=c.precision,o=c.rounding,e.eq(1))return h(a,r,o);if(t=_(e.e/b),t>=e.d.length-1&&(n=u<0?-u:u)<=Pn)return i=Ct(c,a,n,r),e.s<0?new c(1).div(i):h(i,r,o);if(s=a.s,s<0){if(t<e.d.length-1)return new c(NaN);if((e.d[t]&1)==0&&(s=1),a.e==0&&a.d[0]==1&&a.d.length==1)return a.s=s,a}return n=M(+a,u),t=n==0||!isFinite(n)?_(u*(Math.log("0."+R(a.d))/Math.LN10+a.e+1)):new c(n+"").e,t>c.maxE+1||t<c.minE-1?new c(t>0?s/0:0):(w=!1,c.rounding=a.s=1,n=Math.min(12,(t+"").length),i=Ze(e.times(Y(a,r+n)),r),i.d&&(i=h(i,r+5,1),fe(i.d,r,o)&&(t=r+10,i=h(Ze(e.times(Y(a,t+n)),t),t+5,1),+R(i.d).slice(r+1,r+15)+1==1e14&&(i=h(i,r+1,0)))),i.s=s,w=!0,c.rounding=o,h(i,r,o))};p.toPrecision=function(e,t){var n,r=this,i=r.constructor;return e===void 0?n=H(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(F(e,1,X),t===void 0?t=i.rounding:F(t,0,8),r=h(new i(r),e,t),n=H(r,e<=r.e||r.e<=i.toExpNeg,e)),r.isNeg()&&!r.isZero()?"-"+n:n};p.toSignificantDigits=p.toSD=function(e,t){var n=this,r=n.constructor;return e===void 0?(e=r.precision,t=r.rounding):(F(e,1,X),t===void 0?t=r.rounding:F(t,0,8)),h(new r(n),e,t)};p.toString=function(){var e=this,t=e.constructor,n=H(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+n:n};p.truncated=p.trunc=function(){return h(new this.constructor(this),this.e+1,1)};p.valueOf=p.toJSON=function(){var e=this,t=e.constructor,n=H(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+n:n};function R(e){var t,n,r,i=e.length-1,o="",s=e[0];if(i>0){for(o+=s,t=1;t<i;t++)r=e[t]+"",n=b-r.length,n&&(o+=Z(n)),o+=r;s=e[t],r=s+"",n=b-r.length,n&&(o+=Z(n))}else if(s===0)return"0";for(;s%10===0;)s/=10;return o+s}function F(e,t,n){if(e!==~~e||e<t||e>n)throw Error(J+e)}function fe(e,t,n,r){var i,o,s,a;for(o=e[0];o>=10;o/=10)--t;return--t<0?(t+=b,i=0):(i=Math.ceil((t+1)/b),t%=b),o=M(10,b-t),a=e[i]%o|0,r==null?t<3?(t==0?a=a/100|0:t==1&&(a=a/10|0),s=n<4&&a==99999||n>3&&a==49999||a==5e4||a==0):s=(n<4&&a+1==o||n>3&&a+1==o/2)&&(e[i+1]/o/100|0)==M(10,t-2)-1||(a==o/2||a==0)&&(e[i+1]/o/100|0)==0:t<4?(t==0?a=a/1e3|0:t==1?a=a/100|0:t==2&&(a=a/10|0),s=(r||n<4)&&a==9999||!r&&n>3&&a==4999):s=((r||n<4)&&a+1==o||!r&&n>3&&a+1==o/2)&&(e[i+1]/o/1e3|0)==M(10,t-3)-1,s}function xe(e,t,n){for(var r,i=[0],o,s=0,a=e.length;s<a;){for(o=i.length;o--;)i[o]*=t;for(i[0]+=He.indexOf(e.charAt(s++)),r=0;r<i.length;r++)i[r]>n-1&&(i[r+1]===void 0&&(i[r+1]=0),i[r+1]+=i[r]/n|0,i[r]%=n)}return i.reverse()}function xn(e,t){var n,r,i;if(t.isZero())return t;r=t.d.length,r<32?(n=Math.ceil(r/3),i=(1/Ce(4,n)).toString()):(n=16,i="2.3283064365386962890625e-10"),e.precision+=n,t=ae(e,1,t.times(i),new e(1));for(var o=n;o--;){var s=t.times(t);t=s.times(s).minus(s).times(8).plus(1)}return e.precision-=n,t}var N=function(){function e(r,i,o){var s,a=0,c=r.length;for(r=r.slice();c--;)s=r[c]*i+a,r[c]=s%o|0,a=s/o|0;return a&&r.unshift(a),r}function t(r,i,o,s){var a,c;if(o!=s)c=o>s?1:-1;else for(a=c=0;a<o;a++)if(r[a]!=i[a]){c=r[a]>i[a]?1:-1;break}return c}function n(r,i,o,s){for(var a=0;o--;)r[o]-=a,a=r[o]<i[o]?1:0,r[o]=a*s+r[o]-i[o];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,o,s,a,c){var u,l,f,m,d,y,g,B,P,E,S,K,re,V,ve,ye,le,Fe,q,we,Pe=r.constructor,Oe=r.s==i.s?1:-1,D=r.d,C=i.d;if(!D||!D[0]||!C||!C[0])return new Pe(!r.s||!i.s||(D?C&&D[0]==C[0]:!C)?NaN:D&&D[0]==0||!C?Oe*0:Oe/0);for(c?(d=1,l=r.e-i.e):(c=G,d=b,l=_(r.e/d)-_(i.e/d)),q=C.length,le=D.length,P=new Pe(Oe),E=P.d=[],f=0;C[f]==(D[f]||0);f++);if(C[f]>(D[f]||0)&&l--,o==null?(V=o=Pe.precision,s=Pe.rounding):a?V=o+(r.e-i.e)+1:V=o,V<0)E.push(1),y=!0;else{if(V=V/d+2|0,f=0,q==1){for(m=0,C=C[0],V++;(f<le||m)&&V--;f++)ve=m*c+(D[f]||0),E[f]=ve/C|0,m=ve%C|0;y=m||f<le}else{for(m=c/(C[0]+1)|0,m>1&&(C=e(C,m,c),D=e(D,m,c),q=C.length,le=D.length),ye=q,S=D.slice(0,q),K=S.length;K<q;)S[K++]=0;we=C.slice(),we.unshift(0),Fe=C[0],C[1]>=c/2&&++Fe;do m=0,u=t(C,S,q,K),u<0?(re=S[0],q!=K&&(re=re*c+(S[1]||0)),m=re/Fe|0,m>1?(m>=c&&(m=c-1),g=e(C,m,c),B=g.length,K=S.length,u=t(g,S,B,K),u==1&&(m--,n(g,q<B?we:C,B,c))):(m==0&&(u=m=1),g=C.slice()),B=g.length,B<K&&g.unshift(0),n(S,g,K,c),u==-1&&(K=S.length,u=t(C,S,q,K),u<1&&(m++,n(S,q<K?we:C,K,c))),K=S.length):u===0&&(m++,S=[0]),E[f++]=m,u&&S[0]?S[K++]=D[ye]||0:(S=[D[ye]],K=1);while((ye++<le||S[0]!==void 0)&&V--);y=S[0]!==void 0}E[0]||E.shift()}if(d==1)P.e=l,xt=y;else{for(f=1,m=E[0];m>=10;m/=10)f++;P.e=f+l*d-1,h(P,a?o+P.e+1:o,s,y)}return P}}();function h(e,t,n,r){var i,o,s,a,c,u,l,f,m,d=e.constructor;e:if(t!=null){if(f=e.d,!f)return e;for(i=1,a=f[0];a>=10;a/=10)i++;if(o=t-i,o<0)o+=b,s=t,l=f[m=0],c=l/M(10,i-s-1)%10|0;else if(m=Math.ceil((o+1)/b),a=f.length,m>=a)if(r){for(;a++<=m;)f.push(0);l=c=0,i=1,o%=b,s=o-b+1}else break e;else{for(l=a=f[m],i=1;a>=10;a/=10)i++;o%=b,s=o-b+i,c=s<0?0:l/M(10,i-s-1)%10|0}if(r=r||t<0||f[m+1]!==void 0||(s<0?l:l%M(10,i-s-1)),u=n<4?(c||r)&&(n==0||n==(e.s<0?3:2)):c>5||c==5&&(n==4||r||n==6&&(o>0?s>0?l/M(10,i-s):0:f[m-1])%10&1||n==(e.s<0?8:7)),t<1||!f[0])return f.length=0,u?(t-=e.e+1,f[0]=M(10,(b-t%b)%b),e.e=-t||0):f[0]=e.e=0,e;if(o==0?(f.length=m,a=1,m--):(f.length=m+1,a=M(10,b-o),f[m]=s>0?(l/M(10,i-s)%M(10,s)|0)*a:0),u)for(;;)if(m==0){for(o=1,s=f[0];s>=10;s/=10)o++;for(s=f[0]+=a,a=1;s>=10;s/=10)a++;o!=a&&(e.e++,f[0]==G&&(f[0]=1));break}else{if(f[m]+=a,f[m]!=G)break;f[m--]=0,a=1}for(o=f.length;f[--o]===0;)f.pop()}return w&&(e.e>d.maxE?(e.d=null,e.e=NaN):e.e<d.minE&&(e.e=0,e.d=[0])),e}function H(e,t,n){if(!e.isFinite())return It(e);var r,i=e.e,o=R(e.d),s=o.length;return t?(n&&(r=n-s)>0?o=o.charAt(0)+"."+o.slice(1)+Z(r):s>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(e.e<0?"e":"e+")+e.e):i<0?(o="0."+Z(-i-1)+o,n&&(r=n-s)>0&&(o+=Z(r))):i>=s?(o+=Z(i+1-s),n&&(r=n-i-1)>0&&(o=o+"."+Z(r))):((r=i+1)<s&&(o=o.slice(0,r)+"."+o.slice(r)),n&&(r=n-s)>0&&(i+1===s&&(o+="."),o+=Z(r))),o}function Ne(e,t){var n=e[0];for(t*=b;n>=10;n/=10)t++;return t}function Se(e,t,n){if(t>Tn)throw w=!0,n&&(e.precision=n),Error(At);return h(new e(Ae),t,1,!0)}function U(e,t,n){if(t>je)throw Error(At);return h(new e(Be),t,n,!0)}function Nt(e){var t=e.length-1,n=t*b+1;if(t=e[t],t){for(;t%10==0;t/=10)n--;for(t=e[0];t>=10;t/=10)n++}return n}function Z(e){for(var t="";e--;)t+="0";return t}function Ct(e,t,n,r){var i,o=new e(1),s=Math.ceil(r/b+4);for(w=!1;;){if(n%2&&(o=o.times(t),Pt(o.d,s)&&(i=!0)),n=_(n/2),n===0){n=o.d.length-1,i&&o.d[n]===0&&++o.d[n];break}t=t.times(t),Pt(t.d,s)}return w=!0,o}function wt(e){return e.d[e.d.length-1]&1}function Lt(e,t,n){for(var r,i=new e(t[0]),o=0;++o<t.length;)if(r=new e(t[o]),r.s)i[n](r)&&(i=r);else{i=r;break}return i}function Ze(e,t){var n,r,i,o,s,a,c,u=0,l=0,f=0,m=e.constructor,d=m.rounding,y=m.precision;if(!e.d||!e.d[0]||e.e>17)return new m(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:0/0);for(t==null?(w=!1,c=y):c=t,a=new m(.03125);e.e>-2;)e=e.times(a),f+=5;for(r=Math.log(M(2,f))/Math.LN10*2+5|0,c+=r,n=o=s=new m(1),m.precision=c;;){if(o=h(o.times(e),c,1),n=n.times(++l),a=s.plus(N(o,n,c,1)),R(a.d).slice(0,c)===R(s.d).slice(0,c)){for(i=f;i--;)s=h(s.times(s),c,1);if(t==null)if(u<3&&fe(s.d,c-r,d,u))m.precision=c+=10,n=o=a=new m(1),l=0,u++;else return h(s,m.precision=y,d,w=!0);else return m.precision=y,s}s=a}}function Y(e,t){var n,r,i,o,s,a,c,u,l,f,m,d=1,y=10,g=e,B=g.d,P=g.constructor,E=P.rounding,S=P.precision;if(g.s<0||!B||!B[0]||!g.e&&B[0]==1&&B.length==1)return new P(B&&!B[0]?-1/0:g.s!=1?NaN:B?0:g);if(t==null?(w=!1,l=S):l=t,P.precision=l+=y,n=R(B),r=n.charAt(0),Math.abs(o=g.e)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)g=g.times(e),n=R(g.d),r=n.charAt(0),d++;o=g.e,r>1?(g=new P("0."+n),o++):g=new P(r+"."+n.slice(1))}else return u=Se(P,l+2,S).times(o+""),g=Y(new P(r+"."+n.slice(1)),l-y).plus(u),P.precision=S,t==null?h(g,S,E,w=!0):g;for(f=g,c=s=g=N(g.minus(1),g.plus(1),l,1),m=h(g.times(g),l,1),i=3;;){if(s=h(s.times(m),l,1),u=c.plus(N(s,new P(i),l,1)),R(u.d).slice(0,l)===R(c.d).slice(0,l))if(c=c.times(2),o!==0&&(c=c.plus(Se(P,l+2,S).times(o+""))),c=N(c,new P(d),l,1),t==null)if(fe(c.d,l-y,E,a))P.precision=l+=y,u=s=g=N(f.minus(1),f.plus(1),l,1),m=h(g.times(g),l,1),i=a=1;else return h(c,P.precision=S,E,w=!0);else return P.precision=S,c;c=u,i+=2}}function It(e){return String(e.s*e.s/0)}function Ye(e,t){var n,r,i;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;t.charCodeAt(r)===48;r++);for(i=t.length;t.charCodeAt(i-1)===48;--i);if(t=t.slice(r,i),t){if(i-=r,e.e=n=n-r-1,e.d=[],r=(n+1)%b,n<0&&(r+=b),r<i){for(r&&e.d.push(+t.slice(0,r)),i-=b;r<i;)e.d.push(+t.slice(r,r+=b));t=t.slice(r),r=b-t.length}else r-=i;for(;r--;)t+="0";e.d.push(+t),w&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function An(e,t){var n,r,i,o,s,a,c,u,l;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),kt.test(t))return Ye(e,t)}else if(t==="Infinity"||t==="NaN")return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(yn.test(t))n=16,t=t.toLowerCase();else if(bn.test(t))n=2;else if(wn.test(t))n=8;else throw Error(J+t);for(o=t.search(/p/i),o>0?(c=+t.slice(o+1),t=t.substring(2,o)):t=t.slice(2),o=t.indexOf("."),s=o>=0,r=e.constructor,s&&(t=t.replace(".",""),a=t.length,o=a-o,i=Ct(r,new r(n),o,o*2)),u=xe(t,n,G),l=u.length-1,o=l;u[o]===0;--o)u.pop();return o<0?new r(e.s*0):(e.e=Ne(u,l),e.d=u,w=!1,s&&(e=N(e,i,a*4)),c&&(e=e.times(Math.abs(c)<54?M(2,c):Le.pow(2,c))),w=!0,e)}function Bn(e,t){var n,r=t.d.length;if(r<3)return t.isZero()?t:ae(e,2,t,t);n=1.4*Math.sqrt(r),n=n>16?16:n|0,t=t.times(1/Ce(5,n)),t=ae(e,2,t,t);for(var i,o=new e(5),s=new e(16),a=new e(20);n--;)i=t.times(t),t=t.times(o.plus(i.times(s.times(i).minus(a))));return t}function ae(e,t,n,r,i){var o,s,a,c,u=1,l=e.precision,f=Math.ceil(l/b);for(w=!1,c=n.times(n),a=new e(r);;){if(s=N(a.times(c),new e(t++*t++),l,1),a=i?r.plus(s):r.minus(s),r=N(s.times(c),new e(t++*t++),l,1),s=a.plus(r),s.d[f]!==void 0){for(o=f;s.d[o]===a.d[o]&&o--;);if(o==-1)break}o=a,a=r,r=s,s=o,u++}return w=!0,s.d.length=f+1,s}function Ce(e,t){for(var n=e;--t;)n*=e;return n}function Et(e,t){var n,r=t.s<0,i=U(e,e.precision,1),o=i.times(.5);if(t=t.abs(),t.lte(o))return j=r?4:1,t;if(n=t.divToInt(i),n.isZero())j=r?3:2;else{if(t=t.minus(n.times(i)),t.lte(o))return j=wt(n)?r?2:3:r?4:1,t;j=wt(n)?r?1:4:r?3:2}return t.minus(i).abs()}function Je(e,t,n,r){var i,o,s,a,c,u,l,f,m,d=e.constructor,y=n!==void 0;if(y?(F(n,1,X),r===void 0?r=d.rounding:F(r,0,8)):(n=d.precision,r=d.rounding),!e.isFinite())l=It(e);else{for(l=H(e),s=l.indexOf("."),y?(i=2,t==16?n=n*4-3:t==8&&(n=n*3-2)):i=t,s>=0&&(l=l.replace(".",""),m=new d(1),m.e=l.length-s,m.d=xe(H(m),10,i),m.e=m.d.length),f=xe(l,10,i),o=c=f.length;f[--c]==0;)f.pop();if(!f[0])l=y?"0p+0":"0";else{if(s<0?o--:(e=new d(e),e.d=f,e.e=o,e=N(e,m,n,r,0,i),f=e.d,o=e.e,u=xt),s=f[n],a=i/2,u=u||f[n+1]!==void 0,u=r<4?(s!==void 0||u)&&(r===0||r===(e.s<0?3:2)):s>a||s===a&&(r===4||u||r===6&&f[n-1]&1||r===(e.s<0?8:7)),f.length=n,u)for(;++f[--n]>i-1;)f[n]=0,n||(++o,f.unshift(1));for(c=f.length;!f[c-1];--c);for(s=0,l="";s<c;s++)l+=He.charAt(f[s]);if(y){if(c>1)if(t==16||t==8){for(s=t==16?4:3,--c;c%s;c++)l+="0";for(f=xe(l,i,t),c=f.length;!f[c-1];--c);for(s=1,l="1.";s<c;s++)l+=He.charAt(f[s])}else l=l.charAt(0)+"."+l.slice(1);l=l+(o<0?"p":"p+")+o}else if(o<0){for(;++o;)l="0"+l;l="0."+l}else if(++o>c)for(o-=c;o--;)l+="0";else o<c&&(l=l.slice(0,o)+"."+l.slice(o))}l=(t==16?"0x":t==2?"0b":t==8?"0o":"")+l}return e.s<0?"-"+l:l}function Pt(e,t){if(e.length>t)return e.length=t,!0}function Sn(e){return new this(e).abs()}function kn(e){return new this(e).acos()}function Nn(e){return new this(e).acosh()}function Cn(e,t){return new this(e).plus(t)}function Ln(e){return new this(e).asin()}function In(e){return new this(e).asinh()}function En(e){return new this(e).atan()}function Kn(e){return new this(e).atanh()}function Mn(e,t){e=new this(e),t=new this(t);var n,r=this.precision,i=this.rounding,o=r+4;return!e.s||!t.s?n=new this(NaN):!e.d&&!t.d?(n=U(this,o,1).times(t.s>0?.25:.75),n.s=e.s):!t.d||e.isZero()?(n=t.s<0?U(this,r,i):new this(0),n.s=e.s):!e.d||t.isZero()?(n=U(this,o,1).times(.5),n.s=e.s):t.s<0?(this.precision=o,this.rounding=1,n=this.atan(N(e,t,o,1)),t=U(this,o,1),this.precision=r,this.rounding=i,n=e.s<0?n.minus(t):n.plus(t)):n=this.atan(N(e,t,o,1)),n}function Rn(e){return new this(e).cbrt()}function Dn(e){return h(e=new this(e),e.e+1,2)}function _n(e,t,n){return new this(e).clamp(t,n)}function vn(e){if(!e||typeof e!="object")throw Error(ke+"Object expected");var t,n,r,i=e.defaults===!0,o=["precision",1,X,"rounding",0,8,"toExpNeg",-se,0,"toExpPos",0,se,"maxE",0,se,"minE",-se,0,"modulo",0,9];for(t=0;t<o.length;t+=3)if(n=o[t],i&&(this[n]=ze[n]),(r=e[n])!==void 0)if(_(r)===r&&r>=o[t+1]&&r<=o[t+2])this[n]=r;else throw Error(J+n+": "+r);if(n="crypto",i&&(this[n]=ze[n]),(r=e[n])!==void 0)if(r===!0||r===!1||r===0||r===1)if(r)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[n]=!0;else throw Error(Bt);else this[n]=!1;else throw Error(J+n+": "+r);return this}function Fn(e){return new this(e).cos()}function On(e){return new this(e).cosh()}function Kt(e){var t,n,r;function i(o){var s,a,c,u=this;if(!(u instanceof i))return new i(o);if(u.constructor=i,Tt(o)){u.s=o.s,w?!o.d||o.e>i.maxE?(u.e=NaN,u.d=null):o.e<i.minE?(u.e=0,u.d=[0]):(u.e=o.e,u.d=o.d.slice()):(u.e=o.e,u.d=o.d?o.d.slice():o.d);return}if(c=typeof o,c==="number"){if(o===0){u.s=1/o<0?-1:1,u.e=0,u.d=[0];return}if(o<0?(o=-o,u.s=-1):u.s=1,o===~~o&&o<1e7){for(s=0,a=o;a>=10;a/=10)s++;w?s>i.maxE?(u.e=NaN,u.d=null):s<i.minE?(u.e=0,u.d=[0]):(u.e=s,u.d=[o]):(u.e=s,u.d=[o]);return}else if(o*0!==0){o||(u.s=NaN),u.e=NaN,u.d=null;return}return Ye(u,o.toString())}else if(c!=="string")throw Error(J+o);return(a=o.charCodeAt(0))===45?(o=o.slice(1),u.s=-1):(a===43&&(o=o.slice(1)),u.s=1),kt.test(o)?Ye(u,o):An(u,o)}if(i.prototype=p,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=vn,i.clone=Kt,i.isDecimal=Tt,i.abs=Sn,i.acos=kn,i.acosh=Nn,i.add=Cn,i.asin=Ln,i.asinh=In,i.atan=En,i.atanh=Kn,i.atan2=Mn,i.cbrt=Rn,i.ceil=Dn,i.clamp=_n,i.cos=Fn,i.cosh=On,i.div=Wn,i.exp=Vn,i.floor=qn,i.hypot=Un,i.ln=Gn,i.log=Hn,i.log10=jn,i.log2=zn,i.max=Zn,i.min=Yn,i.mod=Jn,i.mul=Xn,i.pow=Qn,i.random=$n,i.round=er,i.sign=tr,i.sin=nr,i.sinh=rr,i.sqrt=ir,i.sub=or,i.sum=sr,i.tan=ar,i.tanh=ur,i.trunc=cr,e===void 0&&(e={}),e&&e.defaults!==!0)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],t=0;t<r.length;)e.hasOwnProperty(n=r[t++])||(e[n]=this[n]);return i.config(e),i}function Wn(e,t){return new this(e).div(t)}function Vn(e){return new this(e).exp()}function qn(e){return h(e=new this(e),e.e+1,3)}function Un(){var e,t,n=new this(0);for(w=!1,e=0;e<arguments.length;)if(t=new this(arguments[e++]),t.d)n.d&&(n=n.plus(t.times(t)));else{if(t.s)return w=!0,new this(1/0);n=t}return w=!0,n.sqrt()}function Tt(e){return e instanceof Le||e&&e.toStringTag===St||!1}function Gn(e){return new this(e).ln()}function Hn(e,t){return new this(e).log(t)}function zn(e){return new this(e).log(2)}function jn(e){return new this(e).log(10)}function Zn(){return Lt(this,arguments,"lt")}function Yn(){return Lt(this,arguments,"gt")}function Jn(e,t){return new this(e).mod(t)}function Xn(e,t){return new this(e).mul(t)}function Qn(e,t){return new this(e).pow(t)}function $n(e){var t,n,r,i,o=0,s=new this(1),a=[];if(e===void 0?e=this.precision:F(e,1,X),r=Math.ceil(e/b),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(r));o<r;)i=t[o],i>=429e7?t[o]=crypto.getRandomValues(new Uint32Array(1))[0]:a[o++]=i%1e7;else if(crypto.randomBytes){for(t=crypto.randomBytes(r*=4);o<r;)i=t[o]+(t[o+1]<<8)+(t[o+2]<<16)+((t[o+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(t,o):(a.push(i%1e7),o+=4);o=r/4}else throw Error(Bt);else for(;o<r;)a[o++]=Math.random()*1e7|0;for(r=a[--o],e%=b,r&&e&&(i=M(10,b-e),a[o]=(r/i|0)*i);a[o]===0;o--)a.pop();if(o<0)n=0,a=[0];else{for(n=-1;a[0]===0;n-=b)a.shift();for(r=1,i=a[0];i>=10;i/=10)r++;r<b&&(n-=b-r)}return s.e=n,s.d=a,s}function er(e){return h(e=new this(e),e.e+1,this.rounding)}function tr(e){return e=new this(e),e.d?e.d[0]?e.s:0*e.s:e.s||NaN}function nr(e){return new this(e).sin()}function rr(e){return new this(e).sinh()}function ir(e){return new this(e).sqrt()}function or(e,t){return new this(e).sub(t)}function sr(){var e=0,t=arguments,n=new this(t[e]);for(w=!1;n.s&&++e<t.length;)n=n.plus(t[e]);return w=!0,h(n,this.precision,this.rounding)}function ar(e){return new this(e).tan()}function ur(e){return new this(e).tanh()}function cr(e){return h(e=new this(e),e.e+1,1)}p[Symbol.for("nodejs.util.inspect.custom")]=p.toString;p[Symbol.toStringTag]="Decimal";var Le=p.constructor=Kt(ze);Ae=new Le(Ae);Be=new Le(Be);import{PublicKey as $e}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as lr}from"@solana/spl-token";import{PublicKey as I,SystemProgram as Mt,SYSVAR_RENT_PUBKEY as fr}from"@solana/web3.js";function Xe({pubkey:e,isSigner:t=!1,isWritable:n=!0}){return{pubkey:e,isWritable:n,isSigner:t}}var eo=[Xe({pubkey:lr,isWritable:!1}),Xe({pubkey:Mt.programId,isWritable:!1}),Xe({pubkey:fr,isWritable:!1})];function Rt({publicKey:e,transformSol:t}){let n=Dt(e.toString());if(n instanceof I)return t&&n.equals(me)?Qe:n;if(t&&n.toString()===me.toBase58())return Qe;if(typeof n=="string"){if(n===I.default.toBase58())return I.default;try{return new I(n)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function Dt(e){try{return new I(e)}catch{return e}}var to=new I("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),_t=new I("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),vt=new I("SysvarRent111111111111111111111111111111111"),no=new I("SysvarC1ock11111111111111111111111111111111"),ro=new I("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),io=new I("Sysvar1nstructions1111111111111111111111111"),Ft=Mt.programId,oo=new I("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),so=new I("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),ao=new I("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),uo=new I("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),co=new I("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),lo=new I("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),fo=new I("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),mo=new I("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),po=new I("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),go=new I("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),ho=new I("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),Qe=new I("So11111111111111111111111111111111111111112"),me=I.default;import{PublicKey as mr}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Ot}from"@solana/spl-token";var Wt={chainId:101,address:mr.default.toBase58(),programId:Ot.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},ne={chainId:101,address:"So11111111111111111111111111111111111111112",programId:Ot.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};var et=class{constructor({mint:t,decimals:n,symbol:r,name:i,skipMint:o=!1,isToken2022:s=!1}){if(t===me.toBase58()||t instanceof $e&&me.equals(t)){this.decimals=ne.decimals,this.symbol=ne.symbol,this.name=ne.name,this.mint=new $e(ne.address),this.isToken2022=!1;return}this.decimals=n,this.symbol=r||t.toString().substring(0,6),this.name=i||t.toString().substring(0,6),this.mint=o?$e.default:Rt({publicKey:t}),this.isToken2022=s}equals(t){return this===t?!0:this.mint.equals(t.mint)}},ue=et;ue.WSOL=new et(ie(ee({},ne),{mint:ne.address}));import Ee from"big.js";import gr from"bn.js";import hr from"decimal.js-light";import pr from"toformat";var dr=pr,pe=dr;var Ie=v("module/fraction"),tt=pe(Ee),de=pe(hr),br={[0]:de.ROUND_DOWN,[1]:de.ROUND_HALF_UP,[2]:de.ROUND_UP},yr={[0]:Ee.roundDown,[1]:Ee.roundHalfUp,[2]:Ee.roundUp},L=class{constructor(t,n=new gr(1)){this.numerator=Q(t),this.denominator=Q(n)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new L(this.denominator,this.numerator)}add(t){let n=t instanceof L?t:new L(Q(t));return this.denominator.eq(n.denominator)?new L(this.numerator.add(n.numerator),this.denominator):new L(this.numerator.mul(n.denominator).add(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}sub(t){let n=t instanceof L?t:new L(Q(t));return this.denominator.eq(n.denominator)?new L(this.numerator.sub(n.numerator),this.denominator):new L(this.numerator.mul(n.denominator).sub(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}mul(t){let n=t instanceof L?t:new L(Q(t));return new L(this.numerator.mul(n.numerator),this.denominator.mul(n.denominator))}div(t){let n=t instanceof L?t:new L(Q(t));return new L(this.numerator.mul(n.denominator),this.denominator.mul(n.numerator))}toSignificant(t,n={groupSeparator:""},r=1){Number.isInteger(t)||Ie.logWithError(`${t} is not an integer.`),t<=0&&Ie.logWithError(`${t} is not positive.`),de.set({precision:t+1,rounding:br[r]});let i=new de(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(t);return i.toFormat(i.decimalPlaces(),n)}toFixed(t,n={groupSeparator:""},r=1){return Number.isInteger(t)||Ie.logWithError(`${t} is not an integer.`),t<0&&Ie.logWithError(`${t} is negative.`),tt.DP=t,tt.RM=yr[r]||1,new tt(this.numerator.toString()).div(this.denominator.toString()).toFormat(t,n)}isZero(){return this.numerator.isZero()}};var qo=v("Raydium_price");var nt=class{constructor({decimals:t,symbol:n="UNKNOWN",name:r="UNKNOWN"}){this.decimals=t,this.symbol=n,this.name=r}equals(t){return this===t}},Ke=nt;Ke.SOL=new nt(Wt);import Pr from"bn.js";var Jo=new L(new Pr(100));var Tr=new O(0),hs=new O(1),bs=new O(2),ys=new O(3),ws=new O(5),xr=new O(10),Ps=new O(100),Ts=new O(1e3),xs=new O(1e4),Gt=9007199254740991;function Q(e){let t=v("Raydium_parseBigNumberish");if(e instanceof O)return e;if(typeof e=="string"){if(e.match(/^-?[0-9]+$/))return new O(e);t.logWithError(`invalid BigNumberish string: ${e}`)}return typeof e=="number"?(e%1&&t.logWithError(`BigNumberish number underflow: ${e}`),(e>=Gt||e<=-Gt)&&t.logWithError(`BigNumberish number overflow: ${e}`),new O(String(e))):typeof e=="bigint"?new O(e.toString()):(t.error(`invalid BigNumberish value: ${e}`),new O(0))}var _s=v("Raydium_amount"),vs=pe(Ar);import{PublicKey as Ja,sendAndConfirmTransaction as Xa,Transaction as $a,TransactionMessage as tu,VersionedTransaction as nu}from"@solana/web3.js";import ou from"axios";import{PublicKey as Br,ComputeBudgetProgram as ia,Transaction as sa,TransactionMessage as ua,Keypair as ca,VersionedTransaction as fa}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as da}from"@solana/spl-token";var ba=v("Raydium_txUtil");function $(e,t){let[n,r]=Br.findProgramAddressSync(e,t);return{publicKey:n,nonce:r}}import{PublicKey as Sr,AddressLookupTableAccount as Ht}from"@solana/web3.js";import{PublicKey as Ba}from"@solana/web3.js";import{MINT_SIZE as ka,TOKEN_PROGRAM_ID as Na,getTransferFeeConfig as Ca,unpackMint as La}from"@solana/spl-token";var Ka=v("Raydium_accountInfo_util");var kr={"2immgwYNHBbyVQKVGCEkgWpi53bLwWNRMB5G2nbgYV17":new Ht({key:new Sr("2immgwYNHBbyVQKVGCEkgWpi53bLwWNRMB5G2nbgYV17"),state:Ht.deserialize(Buffer.from("AQAAAP//////////d49+DAAAAAAAAQZMWvw7GUNJdaccNBVnb57OKakxL2BHLYvhRwVILRsgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMGRm/lIRcy/+ytunLDm+e8jOW7xfcSayxDmzpAAAAABt324ddloZPZy+FGzut5rBy0he1fWzeROoz1hX7/AKkG3fbh7nWP3hhCXbzkbM3athr8TYO5DSf+vfko2KGL/AVKU1D4XciC1hSlVnJ4iilt3x6rq9CmBniISTL07vagBqfVFxksXFEhjMlMPUrxf1ja7gibof1E49vZigAAAAAGp9UXGMd0yShWY5hpHV62i164o5tLbVxzVVshAAAAAIyXJY9OJInxuz0QKRSODYMLWhOZ2v8QhASOe9jb6fhZC3BlsePRfEU4nVJ/awTDzVi4bHMaoP21SbbRvAP4KUbIScv+6Yw2LHF/6K0ZjUPibbSWXCirYPGuuVl7zT789IUPLW4CpHr4JNCatp3ELXDLKMv6JJ+37le50lbBJ2LvDQdRqCgtphMF/imcN7mY5YRx2xE1A3MQ+L4QRaYK9u4GRfZP3LsAd00a+IkCpA22UNQMKdq5BFbJuwuOLqc8zxCTDlqxBG8J0HcxtfogQHDK06ukzfaXiNDKAob1MqBHS9lJxDYCwz8gd5DtFqNSTKG5l1zxIaKpDP/sffi2is1H9aKveyXSu5StXElYRl9SD5As0DHE4N0GLnf84/siiKXVyp4Ez121kLcUui/jLLFZEz/BwZK3Ilf9B9OcsEAeDMKAy2vjGSxQODgBz0QwGA+eP4ZjIjrIAQaXENv31QfLlOdXSRCkaybRniDHF4C8YcwhcvsqrOVuTP4B2Na+9wLdtrB31uz2rtlFI5kahdsnp/d1SrASDInYCtTYtdoke4kX+hoKWcEWM4Tle8pTUkUVv4BxS6fje/EzKBE4Qu9N9LMnrw/JNO0hqMVB4rk/2ou4AB1loQ7FZoPwut2o4KZB+0p9xnbrQKw038qjpHar+PyDwvxBRcu5hpHw3dguezeWv+IwvgW5icu8EGkhGa9AkFPPJT7VMSFb8xowveU=","base64"))})};import{PublicKey as A}from"@solana/web3.js";var gu=new A("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),hu=new A("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),bu=new A("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),yu=new A("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),wu=new A("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),Pu=new A("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),Tu=new A("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),xu=new A("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),Au=new A("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),Bu=new A("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),Su=new A("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),ku=new A("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),Nu=new A("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),Cu=new A("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),Lu=new A("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),Iu=new A("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),Eu=new A("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),Ku=new A("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),Mu=new A("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),Nr=new A("CPMDWBwJDtYax9qW7AyRuVC19Cc4L4Vcy4n2BHAbHkCW"),Cr=new A("7rQ1QFNosMkUCuh7Z7fPbTHvh73b68sQYdirycEzJVuw"),Lr=new A("G11FKBRaAkHAKuLCgLM6K6NUc9rTjPAznRCjZifrTQe2");var Ru={SERUM_MARKET:A.default,OPENBOOK_MARKET:new A("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),UTIL1216:A.default,FarmV3:new A("85BFyr98MbCUU9MVTEgzx1nbhWACbJqLzho6zd6DZcWL"),FarmV5:new A("EcLzTrNg9V7qhcdyXDe2qjtPkiGzDM2UbdRaeaadU5r2"),FarmV6:new A("Farm2hJLcqPtPg8M4rR6DMrsRNc5TPm5Cs4bVQrMe2T7"),AmmV4:new A("HWy1jotHpo6UqeQxx49dpYYdQB8wj9Qk9MdxwjLvDHB8"),AmmStable:new A("DDg4VmQaJV9ogWce7LpcjBA9bv22wRp5uaTPa5pGjijF"),CLMM:new A("devi51mZmdwUJGU9hjN27vEz64Gps7uUefqxg27EAtH"),Router:new A("BVChZ3XFEwTMUk1o9i3HAf91H6mFxSwa5X2wFAWhYPhU"),CREATE_CPMM_POOL_PROGRAM:Nr,CREATE_CPMM_POOL_AUTH:Cr,CREATE_CPMM_POOL_FEE_ACC:Lr,FEE_DESTINATION_ID:new A("3XMrhbv989VxAMi3DErLV9eJht1pHppW5LbKxe9fkEFR")};import{PublicKey as vu}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Wu}from"@solana/spl-token";import zt from"bn.js";function rt(e,t){let{div:n,mod:r}=e.divmod(t);return r.gt(new zt(0))?n.add(new zt(1)):n}var Er=v("Raydium_cpmm"),he={initialize:[175,175,109,31,13,152,155,237],deposit:[242,35,198,137,82,225,242,182],withdraw:[183,18,70,156,148,109,161,34],swapBaseInput:[143,190,90,218,196,30,51,222],swapBaseOutput:[55,217,98,86,163,74,180,173]};function pc(e,t,n,r,i,o,s,a,c,u,l,f,m,d,y,g,B,P,E,S){let K=z([k("amountMaxA"),k("amountMaxB"),k("openTime")]),re=[{pubkey:t,isSigner:!0,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:B,isSigner:!1,isWritable:!0},{pubkey:it,isSigner:!1,isWritable:!1},{pubkey:y,isSigner:!1,isWritable:!1},{pubkey:g,isSigner:!1,isWritable:!1},{pubkey:Ir,isSigner:!1,isWritable:!1},{pubkey:Ft,isSigner:!1,isWritable:!1},{pubkey:vt,isSigner:!1,isWritable:!1}],V=Buffer.alloc(K.span);return K.encode({amountMaxA:P,amountMaxB:E,openTime:S},V),new ge({keys:re,programId:e,data:Buffer.from([...he.initialize,...V])})}function dc(e,t,n,r,i,o,s,a,c,u,l,f,m,d,y){let g=z([k("lpAmount"),k("amountMaxA"),k("amountMaxB")]),B=[{pubkey:t,isSigner:!0,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:it,isSigner:!1,isWritable:!1},{pubkey:jt,isSigner:!1,isWritable:!1},{pubkey:u,isSigner:!1,isWritable:!1},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:f,isSigner:!1,isWritable:!0}],P=Buffer.alloc(g.span);return Er.debug("cpmm deposit data",{lpAmount:m.toString(),amountMaxA:d.toString(),amountMaxB:y.toString()}),g.encode({lpAmount:m,amountMaxA:d,amountMaxB:y},P),new ge({keys:B,programId:e,data:Buffer.from([...he.deposit,...P])})}function gc(e,t,n,r,i,o,s,a,c,u,l,f,m,d,y){let g=z([k("lpAmount"),k("amountMinA"),k("amountMinB")]),B=[{pubkey:t,isSigner:!0,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:it,isSigner:!1,isWritable:!1},{pubkey:jt,isSigner:!1,isWritable:!1},{pubkey:u,isSigner:!1,isWritable:!1},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:_t,isSigner:!1,isWritable:!1}],P=Buffer.alloc(g.span);return g.encode({lpAmount:m,amountMinA:d,amountMinB:y},P),new ge({keys:B,programId:e,data:Buffer.from([...he.withdraw,...P])})}function hc(e,t,n,r,i,o,s,a,c,u,l,f,m,d,y,g){let B=z([k("amountIn"),k("amounOutMin")]),P=[{pubkey:t,isSigner:!0,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!1},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:f,isSigner:!1,isWritable:!1},{pubkey:m,isSigner:!1,isWritable:!1},{pubkey:d,isSigner:!1,isWritable:!0}],E=Buffer.alloc(B.span);return B.encode({amountIn:y,amounOutMin:g},E),new ge({keys:P,programId:e,data:Buffer.from([...he.swapBaseInput,...E])})}function bc(e,t,n,r,i,o,s,a,c,u,l,f,m,d,y,g){let B=z([k("amountInMax"),k("amountOut")]),P=[{pubkey:t,isSigner:!0,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!1},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:f,isSigner:!1,isWritable:!1},{pubkey:m,isSigner:!1,isWritable:!1},{pubkey:d,isSigner:!1,isWritable:!0}],E=Buffer.alloc(B.span);return B.encode({amountInMax:y,amountOut:g},E),new ge({keys:P,programId:e,data:Buffer.from([...he.swapBaseOutput,...E])})}var Kr=Buffer.from("vault_and_lp_mint_auth_seed","utf8"),Mr=Buffer.from("amm_config","utf8"),Rr=Buffer.from("pool","utf8"),Dr=Buffer.from("pool_lp_mint","utf8"),_r=Buffer.from("pool_vault","utf8"),vr=Buffer.from("observation","utf8");function Fr(e){return $([Kr],e)}function Pc(e,t){return $([Mr,qr(t)],e)}function Or(e,t,n,r){return $([Rr,t.toBuffer(),n.toBuffer(),r.toBuffer()],e)}function Wr(e,t){return $([Dr,t.toBuffer()],e)}function Zt(e,t,n){return $([_r,t.toBuffer(),n.toBuffer()],e)}function Vr(e,t){return $([vr,t.toBuffer()],e)}function qr(e){let t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e,!1),new Uint8Array(t)}function Tc({programId:e,configId:t,mintA:n,mintB:r}){let i=Fr(e).publicKey,o=Or(e,t,n,r).publicKey,s=Wr(e,o).publicKey,a=Zt(e,o,n).publicKey,c=Zt(e,o,r).publicKey,u=Vr(e,o).publicKey;return{poolId:o,configId:t,authority:i,lpMint:s,vaultA:a,vaultB:c,observationId:u}}import st from"bn.js";import Jt from"bn.js";var ot=new Jt(1e6);function Ur(e,t,n){return e.mul(t).add(n).sub(new Jt(1)).div(n)}function Yt(e,t,n){return e.mul(t).div(n)}var Me=class{static tradingFee(t,n){return Ur(t,n,ot)}static protocolFee(t,n){return Yt(t,n,ot)}static fundFee(t,n){return Yt(t,n,ot)}};import be from"bn.js";function Re(e,t){if(t.isZero())throw Error("divisor is zero");return e.mod(t)}function Gr(e,t){if(t.isZero())throw Error("rhs is zero");let n=e.div(t);if(n.isZero())throw Error("quotient is zero");let r=Re(e,t);return r.gt(ce)&&(n=n.add(new be(1)),t=e.div(n),r=Re(e,n),r.gt(ce)&&(t=t.add(new be(1)))),[n,t]}var ce=new be(0),De=class{static swapWithoutFees(t,n,r){let i=n.mul(r),o=n.add(t),[s,a]=Gr(i,o),c=a.sub(n),u=r.sub(s);if(u.isZero())throw Error("destinationAmountSwapped is zero");return{sourceAmountSwapped:c,destinationAmountSwapped:u}}static lpTokensToTradingTokens(t,n,r,i,o){let s=t.mul(r).div(n),a=t.mul(i).div(n);if(o===0)return{tokenAmount0:s,tokenAmount1:a};if(o===1)return Re(t.mul(r),n).gt(ce)&&s.gt(ce)&&(s=s.add(new be(1))),Re(t.mul(i),n).gt(ce)&&a.gt(ce)&&(a=a.add(new be(1))),{tokenAmount0:s,tokenAmount1:a};throw Error("roundDirection value error")}};import _e from"decimal.js-light";var Xt=(n=>(n[n.Floor=0]="Floor",n[n.Ceiling=1]="Ceiling",n))(Xt||{}),Qt=class{static validate_supply(t,n){if(t.isZero())throw Error("tokenAmount0 is zero");if(n.isZero())throw Error("tokenAmount1 is zero")}static swap(t,n,r,i){let o=Me.tradingFee(t,i),s=t.sub(o),{sourceAmountSwapped:a,destinationAmountSwapped:c}=De.swapWithoutFees(s,n,r),u=a.add(o);return{newSwapSourceAmount:n.add(u),newSwapDestinationAmount:r.sub(c),sourceAmountSwapped:u,destinationAmountSwapped:c,tradeFee:o}}static swapBaseOut({poolMintA:t,poolMintB:n,tradeFeeRate:r,baseReserve:i,quoteReserve:o,outputMint:s,outputAmount:a}){let[c,u,l,f,m]=n.address===s.toString()?[i,o,t.decimals,n.decimals,t.address]:[o,i,n.decimals,t.decimals,n.address],d=new _e(u.toString()).div(10**f).div(new _e(c.toString()).div(10**l)),y=a.gte(u)?u.sub(new st(1)):a,g=u.sub(y),B=rt(c.mul(y),g),P=rt(B.mul(new st(1e6)),new st(1e6).sub(r)),E=P.sub(B),S=new _e(y.toString()).div(10**f).div(new _e(P.toString()).div(10**l)),K=d.isZero()?0:S.sub(d).div(d).abs().toNumber();return{amountRealOut:y,amountIn:P,amountInWithoutFee:B,tradeFee:E,priceImpact:K}}};export{De as ConstantProductCurve,Hi as CpmmConfigInfoLayout,Me as CpmmFee,zi as CpmmPoolInfoLayout,Qt as CurveCalculator,ot as FEE_RATE_DENOMINATOR_VALUE,Xt as RoundDirection,Ur as ceilDiv,Yt as floorDiv,Pc as getCpmmPdaAmmConfigId,Or as getCpmmPdaPoolId,Tc as getCreatePoolKeys,Wr as getPdaLpMint,Vr as getPdaObservationId,Fr as getPdaPoolAuthority,Zt as getPdaVault,pc as makeCreateCpmmPoolInInstruction,dc as makeDepositCpmmInInstruction,hc as makeSwapCpmmBaseInInInstruction,bc as makeSwapCpmmBaseOutInInstruction,gc as makeWithdrawCpmmInInstruction};
//# sourceMappingURL=index.mjs.map